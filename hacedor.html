
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>BIGRAMA &#8212; Dantis Elementorum</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/logo.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Dantis Elementorum</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Intro
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementorum Physicæ Mathematicæ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="programacion.html">
   Elementos de programación
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="redes.html">
   Elementos de redes neuronales
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementorum Iurisprudentiæ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="iurisprudentiae.html">
   Elementos de leyes, o Nova methodus discendæ iurisprudentiæ
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementorum Poeticæ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="borges.html">
   Elementos de El Aleph​
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exagium
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="tzompantli.html">
   Breve ensayo sobre el tzompantli
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="castillos.html">
   La importancia de ser olvidado
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/DanteNoguez/Ensayos/main?urlpath=tree/ensayos/hacedor.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/DanteNoguez/Ensayos"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/DanteNoguez/Ensayos/issues/new?title=Issue%20on%20page%20%2Fhacedor.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/hacedor.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   BIGRAMA
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#red-neuronal">
   RED NEURONAL
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>BIGRAMA</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   BIGRAMA
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#red-neuronal">
   RED NEURONAL
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1">#nombres = pd.read_csv(&#39;historico-nombres.csv&#39;).iloc[0:200000]</span>
<span class="c1">#regex = &quot;[^a-z]&quot;</span>
<span class="c1">#nombres = nombres[&#39;nombre&#39;].str.lower()</span>
<span class="c1">#filtro = nombres.str.contains(&quot;[^a-z]&quot;)</span>
<span class="c1">#nombres = nombres[~filtro].astype(&#39;str&#39;)</span>

<span class="c1">#nombres.to_csv(r&#39;nombres.txt&#39;, header=None, index=None, mode=&#39;a&#39;)</span>
<span class="c1">#nombres.head(10)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">palabras</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;nombres.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">palabras</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;maria&#39;,
 &#39;rosa&#39;,
 &#39;jose&#39;,
 &#39;carmen&#39;,
 &#39;ana&#39;,
 &#39;juana&#39;,
 &#39;antonio&#39;,
 &#39;elena&#39;,
 &#39;teresa&#39;,
 &#39;angela&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">palabras</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21029
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="bigrama">
<h1>BIGRAMA<a class="headerlink" href="#bigrama" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palabras</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
  <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;I&gt;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;&lt;F&gt;&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">bigrama</span> <span class="o">=</span> <span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
    <span class="n">b</span><span class="p">[</span><span class="n">bigrama</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bigrama</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;I&gt; m
m a
a r
r i
i a
a &lt;F&gt;
&lt;I&gt; r
r o
o s
s a
a &lt;F&gt;
&lt;I&gt; j
j o
o s
s e
e &lt;F&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;&lt;I&gt;&#39;, &#39;m&#39;): 1,
 (&#39;m&#39;, &#39;a&#39;): 1,
 (&#39;a&#39;, &#39;r&#39;): 1,
 (&#39;r&#39;, &#39;i&#39;): 1,
 (&#39;i&#39;, &#39;a&#39;): 1,
 (&#39;a&#39;, &#39;&lt;F&gt;&#39;): 2,
 (&#39;&lt;I&gt;&#39;, &#39;r&#39;): 1,
 (&#39;r&#39;, &#39;o&#39;): 1,
 (&#39;o&#39;, &#39;s&#39;): 2,
 (&#39;s&#39;, &#39;a&#39;): 1,
 (&#39;&lt;I&gt;&#39;, &#39;j&#39;): 1,
 (&#39;j&#39;, &#39;o&#39;): 1,
 (&#39;s&#39;, &#39;e&#39;): 1,
 (&#39;e&#39;, &#39;&lt;F&gt;&#39;): 1}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palabras</span><span class="p">:</span>
  <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;I&gt;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;&lt;F&gt;&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">bigrama</span> <span class="o">=</span> <span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
    <span class="n">b</span><span class="p">[</span><span class="n">bigrama</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bigrama</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="o">-</span><span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[((&#39;a&#39;, &#39;&lt;F&gt;&#39;), 10750),
 ((&#39;o&#39;, &#39;&lt;F&gt;&#39;), 5515),
 ((&#39;i&#39;, &#39;n&#39;), 3768),
 ((&#39;n&#39;, &#39;a&#39;), 3525),
 ((&#39;i&#39;, &#39;a&#39;), 3419),
 ((&#39;l&#39;, &#39;i&#39;), 3390),
 ((&#39;e&#39;, &#39;l&#39;), 3231),
 ((&#39;a&#39;, &#39;n&#39;), 2893),
 ((&#39;&lt;I&gt;&#39;, &#39;a&#39;), 2611),
 ((&#39;e&#39;, &#39;r&#39;), 2359),
 ((&#39;r&#39;, &#39;i&#39;), 2335),
 ((&#39;&lt;I&gt;&#39;, &#39;e&#39;), 2205),
 ((&#39;a&#39;, &#39;r&#39;), 2031),
 ((&#39;i&#39;, &#39;o&#39;), 2022),
 ((&#39;d&#39;, &#39;a&#39;), 2017),
 ((&#39;a&#39;, &#39;l&#39;), 1787),
 ((&#39;c&#39;, &#39;i&#39;), 1783),
 ((&#39;l&#39;, &#39;a&#39;), 1750),
 ((&#39;i&#39;, &#39;l&#39;), 1710),
 ((&#39;r&#39;, &#39;a&#39;), 1676),
 ((&#39;e&#39;, &#39;n&#39;), 1650),
 ((&#39;m&#39;, &#39;a&#39;), 1553),
 ((&#39;o&#39;, &#39;r&#39;), 1527),
 ((&#39;d&#39;, &#39;o&#39;), 1505),
 ((&#39;t&#39;, &#39;a&#39;), 1478),
 ((&#39;n&#39;, &#39;o&#39;), 1472),
 ((&#39;&lt;I&gt;&#39;, &#39;c&#39;), 1465),
 ((&#39;n&#39;, &#39;i&#39;), 1448),
 ((&#39;o&#39;, &#39;n&#39;), 1349),
 ((&#39;m&#39;, &#39;i&#39;), 1265),
 ((&#39;d&#39;, &#39;e&#39;), 1256),
 ((&#39;&lt;I&gt;&#39;, &#39;s&#39;), 1248),
 ((&#39;&lt;I&gt;&#39;, &#39;l&#39;), 1230),
 ((&#39;&lt;I&gt;&#39;, &#39;m&#39;), 1228),
 ((&#39;r&#39;, &#39;o&#39;), 1204),
 ((&#39;n&#39;, &#39;d&#39;), 1160),
 ((&#39;e&#39;, &#39;s&#39;), 1127),
 ((&#39;l&#39;, &#39;e&#39;), 1123),
 ((&#39;s&#39;, &#39;a&#39;), 1086),
 ((&#39;i&#39;, &#39;s&#39;), 1073),
 ((&#39;d&#39;, &#39;i&#39;), 1054),
 ((&#39;s&#39;, &#39;i&#39;), 1049),
 ((&#39;&lt;I&gt;&#39;, &#39;d&#39;), 1038),
 ((&#39;t&#39;, &#39;o&#39;), 1032),
 ((&#39;&lt;I&gt;&#39;, &#39;r&#39;), 1014),
 ((&#39;r&#39;, &#39;e&#39;), 1014),
 ((&#39;i&#39;, &#39;d&#39;), 1006),
 ((&#39;b&#39;, &#39;e&#39;), 965),
 ((&#39;o&#39;, &#39;l&#39;), 943),
 ((&#39;&lt;I&gt;&#39;, &#39;f&#39;), 941),
 ((&#39;s&#39;, &#39;t&#39;), 939),
 ((&#39;&lt;I&gt;&#39;, &#39;g&#39;), 924),
 ((&#39;e&#39;, &#39;&lt;F&gt;&#39;), 922),
 ((&#39;i&#39;, &#39;c&#39;), 914),
 ((&#39;&lt;I&gt;&#39;, &#39;n&#39;), 913),
 ((&#39;&lt;I&gt;&#39;, &#39;b&#39;), 909),
 ((&#39;t&#39;, &#39;i&#39;), 907),
 ((&#39;l&#39;, &#39;d&#39;), 894),
 ((&#39;c&#39;, &#39;a&#39;), 851),
 ((&#39;v&#39;, &#39;i&#39;), 849),
 ((&#39;n&#39;, &#39;&lt;F&gt;&#39;), 837),
 ((&#39;m&#39;, &#39;e&#39;), 836),
 ((&#39;a&#39;, &#39;d&#39;), 829),
 ((&#39;i&#39;, &#39;r&#39;), 797),
 ((&#39;a&#39;, &#39;s&#39;), 796),
 ((&#39;t&#39;, &#39;e&#39;), 785),
 ((&#39;&lt;I&gt;&#39;, &#39;p&#39;), 774),
 ((&#39;n&#39;, &#39;e&#39;), 758),
 ((&#39;c&#39;, &#39;e&#39;), 757),
 ((&#39;s&#39;, &#39;&lt;F&gt;&#39;), 742),
 ((&#39;l&#39;, &#39;o&#39;), 738),
 ((&#39;s&#39;, &#39;e&#39;), 729),
 ((&#39;&lt;I&gt;&#39;, &#39;i&#39;), 726),
 ((&#39;a&#39;, &#39;c&#39;), 689),
 ((&#39;&lt;I&gt;&#39;, &#39;h&#39;), 668),
 ((&#39;r&#39;, &#39;t&#39;), 621),
 ((&#39;e&#39;, &#39;o&#39;), 620),
 ((&#39;o&#39;, &#39;s&#39;), 611),
 ((&#39;n&#39;, &#39;c&#39;), 602),
 ((&#39;n&#39;, &#39;t&#39;), 592),
 ((&#39;i&#39;, &#39;t&#39;), 587),
 ((&#39;&lt;I&gt;&#39;, &#39;o&#39;), 584),
 ((&#39;e&#39;, &#39;d&#39;), 581),
 ((&#39;&lt;I&gt;&#39;, &#39;t&#39;), 578),
 ((&#39;a&#39;, &#39;m&#39;), 570),
 ((&#39;g&#39;, &#39;i&#39;), 570),
 ((&#39;g&#39;, &#39;e&#39;), 562),
 ((&#39;&lt;I&gt;&#39;, &#39;v&#39;), 548),
 ((&#39;a&#39;, &#39;t&#39;), 542),
 ((&#39;a&#39;, &#39;u&#39;), 532),
 ((&#39;&lt;I&gt;&#39;, &#39;j&#39;), 522),
 ((&#39;b&#39;, &#39;a&#39;), 517),
 ((&#39;c&#39;, &#39;o&#39;), 508),
 ((&#39;e&#39;, &#39;t&#39;), 507),
 ((&#39;r&#39;, &#39;m&#39;), 506),
 ((&#39;e&#39;, &#39;m&#39;), 503),
 ((&#39;v&#39;, &#39;e&#39;), 499),
 ((&#39;v&#39;, &#39;a&#39;), 498),
 ((&#39;l&#39;, &#39;&lt;F&gt;&#39;), 487),
 ((&#39;i&#39;, &#39;m&#39;), 481),
 ((&#39;r&#39;, &#39;&lt;F&gt;&#39;), 467),
 ((&#39;f&#39;, &#39;i&#39;), 448),
 ((&#39;u&#39;, &#39;r&#39;), 447),
 ((&#39;u&#39;, &#39;l&#39;), 444),
 ((&#39;a&#39;, &#39;b&#39;), 434),
 ((&#39;h&#39;, &#39;e&#39;), 389),
 ((&#39;u&#39;, &#39;n&#39;), 389),
 ((&#39;u&#39;, &#39;s&#39;), 388),
 ((&#39;f&#39;, &#39;e&#39;), 387),
 ((&#39;p&#39;, &#39;a&#39;), 374),
 ((&#39;b&#39;, &#39;i&#39;), 374),
 ((&#39;i&#39;, &#39;e&#39;), 373),
 ((&#39;o&#39;, &#39;m&#39;), 364),
 ((&#39;l&#39;, &#39;m&#39;), 363),
 ((&#39;f&#39;, &#39;a&#39;), 356),
 ((&#39;m&#39;, &#39;o&#39;), 339),
 ((&#39;u&#39;, &#39;d&#39;), 339),
 ((&#39;l&#39;, &#39;v&#39;), 337),
 ((&#39;i&#39;, &#39;&lt;F&gt;&#39;), 334),
 ((&#39;r&#39;, &#39;c&#39;), 327),
 ((&#39;u&#39;, &#39;i&#39;), 317),
 ((&#39;c&#39;, &#39;l&#39;), 315),
 ((&#39;l&#39;, &#39;u&#39;), 314),
 ((&#39;g&#39;, &#39;u&#39;), 312),
 ((&#39;r&#39;, &#39;u&#39;), 309),
 ((&#39;g&#39;, &#39;a&#39;), 307),
 ((&#39;i&#39;, &#39;g&#39;), 296),
 ((&#39;e&#39;, &#39;u&#39;), 296),
 ((&#39;o&#39;, &#39;d&#39;), 294),
 ((&#39;q&#39;, &#39;u&#39;), 292),
 ((&#39;h&#39;, &#39;i&#39;), 285),
 ((&#39;t&#39;, &#39;r&#39;), 282),
 ((&#39;l&#39;, &#39;f&#39;), 281),
 ((&#39;r&#39;, &#39;d&#39;), 279),
 ((&#39;z&#39;, &#39;a&#39;), 279),
 ((&#39;s&#39;, &#39;o&#39;), 278),
 ((&#39;f&#39;, &#39;r&#39;), 275),
 ((&#39;l&#39;, &#39;l&#39;), 273),
 ((&#39;a&#39;, &#39;i&#39;), 264),
 ((&#39;e&#39;, &#39;c&#39;), 262),
 ((&#39;e&#39;, &#39;v&#39;), 253),
 ((&#39;f&#39;, &#39;o&#39;), 248),
 ((&#39;i&#39;, &#39;b&#39;), 247),
 ((&#39;r&#39;, &#39;n&#39;), 246),
 ((&#39;p&#39;, &#39;e&#39;), 244),
 ((&#39;p&#39;, &#39;i&#39;), 241),
 ((&#39;e&#39;, &#39;g&#39;), 235),
 ((&#39;j&#39;, &#39;a&#39;), 234),
 ((&#39;&lt;I&gt;&#39;, &#39;z&#39;), 233),
 ((&#39;u&#39;, &#39;e&#39;), 232),
 ((&#39;a&#39;, &#39;g&#39;), 229),
 ((&#39;i&#39;, &#39;v&#39;), 225),
 ((&#39;n&#39;, &#39;s&#39;), 224),
 ((&#39;e&#39;, &#39;a&#39;), 223),
 ((&#39;a&#39;, &#39;v&#39;), 221),
 ((&#39;b&#39;, &#39;r&#39;), 220),
 ((&#39;&lt;I&gt;&#39;, &#39;y&#39;), 218),
 ((&#39;d&#39;, &#39;r&#39;), 213),
 ((&#39;h&#39;, &#39;a&#39;), 211),
 ((&#39;r&#39;, &#39;g&#39;), 207),
 ((&#39;p&#39;, &#39;o&#39;), 203),
 ((&#39;n&#39;, &#39;g&#39;), 196),
 ((&#39;l&#39;, &#39;b&#39;), 195),
 ((&#39;g&#39;, &#39;r&#39;), 194),
 ((&#39;d&#39;, &#39;&lt;F&gt;&#39;), 194),
 ((&#39;s&#39;, &#39;u&#39;), 192),
 ((&#39;u&#39;, &#39;c&#39;), 189),
 ((&#39;u&#39;, &#39;a&#39;), 187),
 ((&#39;c&#39;, &#39;t&#39;), 183),
 ((&#39;j&#39;, &#39;u&#39;), 180),
 ((&#39;c&#39;, &#39;r&#39;), 180),
 ((&#39;s&#39;, &#39;c&#39;), 178),
 ((&#39;d&#39;, &#39;u&#39;), 175),
 ((&#39;o&#39;, &#39;t&#39;), 175),
 ((&#39;p&#39;, &#39;r&#39;), 172),
 ((&#39;o&#39;, &#39;c&#39;), 170),
 ((&#39;t&#39;, &#39;u&#39;), 169),
 ((&#39;&lt;I&gt;&#39;, &#39;w&#39;), 169),
 ((&#39;e&#39;, &#39;f&#39;), 168),
 ((&#39;y&#39;, &#39;&lt;F&gt;&#39;), 166),
 ((&#39;c&#39;, &#39;h&#39;), 166),
 ((&#39;o&#39;, &#39;b&#39;), 164),
 ((&#39;s&#39;, &#39;l&#39;), 164),
 ((&#39;o&#39;, &#39;v&#39;), 162),
 ((&#39;j&#39;, &#39;o&#39;), 161),
 ((&#39;g&#39;, &#39;o&#39;), 160),
 ((&#39;n&#39;, &#39;u&#39;), 159),
 ((&#39;m&#39;, &#39;u&#39;), 158),
 ((&#39;u&#39;, &#39;m&#39;), 154),
 ((&#39;&lt;I&gt;&#39;, &#39;u&#39;), 154),
 ((&#39;f&#39;, &#39;l&#39;), 149),
 ((&#39;r&#39;, &#39;l&#39;), 146),
 ((&#39;k&#39;, &#39;o&#39;), 145),
 ((&#39;e&#39;, &#39;i&#39;), 144),
 ((&#39;e&#39;, &#39;b&#39;), 143),
 ((&#39;t&#39;, &#39;t&#39;), 141),
 ((&#39;u&#39;, &#39;b&#39;), 138),
 ((&#39;h&#39;, &#39;o&#39;), 136),
 ((&#39;n&#39;, &#39;z&#39;), 132),
 ((&#39;a&#39;, &#39;z&#39;), 131),
 ((&#39;s&#39;, &#39;m&#39;), 130),
 ((&#39;i&#39;, &#39;z&#39;), 129),
 ((&#39;z&#39;, &#39;i&#39;), 127),
 ((&#39;t&#39;, &#39;&lt;F&gt;&#39;), 121),
 ((&#39;l&#39;, &#39;s&#39;), 118),
 ((&#39;c&#39;, &#39;u&#39;), 117),
 ((&#39;z&#39;, &#39;o&#39;), 117),
 ((&#39;b&#39;, &#39;o&#39;), 117),
 ((&#39;t&#39;, &#39;h&#39;), 115),
 ((&#39;l&#39;, &#39;c&#39;), 115),
 ((&#39;n&#39;, &#39;n&#39;), 114),
 ((&#39;i&#39;, &#39;f&#39;), 112),
 ((&#39;r&#39;, &#39;s&#39;), 112),
 ((&#39;z&#39;, &#39;e&#39;), 110),
 ((&#39;u&#39;, &#39;t&#39;), 105),
 ((&#39;w&#39;, &#39;a&#39;), 105),
 ((&#39;i&#39;, &#39;p&#39;), 102),
 ((&#39;o&#39;, &#39;f&#39;), 102),
 ((&#39;s&#39;, &#39;p&#39;), 102),
 ((&#39;z&#39;, &#39;&lt;F&gt;&#39;), 100),
 ((&#39;b&#39;, &#39;l&#39;), 100),
 ((&#39;r&#39;, &#39;f&#39;), 100),
 ((&#39;j&#39;, &#39;e&#39;), 99),
 ((&#39;a&#39;, &#39;q&#39;), 98),
 ((&#39;e&#39;, &#39;p&#39;), 97),
 ((&#39;a&#39;, &#39;e&#39;), 93),
 ((&#39;i&#39;, &#39;k&#39;), 93),
 ((&#39;a&#39;, &#39;p&#39;), 93),
 ((&#39;a&#39;, &#39;y&#39;), 89),
 ((&#39;&lt;I&gt;&#39;, &#39;k&#39;), 88),
 ((&#39;m&#39;, &#39;&lt;F&gt;&#39;), 87),
 ((&#39;k&#39;, &#39;a&#39;), 87),
 ((&#39;r&#39;, &#39;b&#39;), 86),
 ((&#39;l&#39;, &#39;t&#39;), 85),
 ((&#39;z&#39;, &#39;u&#39;), 82),
 ((&#39;a&#39;, &#39;f&#39;), 81),
 ((&#39;m&#39;, &#39;b&#39;), 80),
 ((&#39;a&#39;, &#39;o&#39;), 79),
 ((&#39;h&#39;, &#39;&lt;F&gt;&#39;), 79),
 ((&#39;o&#39;, &#39;g&#39;), 79),
 ((&#39;y&#39;, &#39;o&#39;), 78),
 ((&#39;g&#39;, &#39;n&#39;), 77),
 ((&#39;o&#39;, &#39;i&#39;), 76),
 ((&#39;b&#39;, &#39;u&#39;), 75),
 ((&#39;r&#39;, &#39;v&#39;), 74),
 ((&#39;y&#39;, &#39;a&#39;), 74),
 ((&#39;k&#39;, &#39;i&#39;), 72),
 ((&#39;y&#39;, &#39;s&#39;), 72),
 ((&#39;e&#39;, &#39;j&#39;), 71),
 ((&#39;e&#39;, &#39;z&#39;), 69),
 ((&#39;s&#39;, &#39;h&#39;), 69),
 ((&#39;a&#39;, &#39;x&#39;), 67),
 ((&#39;l&#39;, &#39;y&#39;), 67),
 ((&#39;x&#39;, &#39;i&#39;), 66),
 ((&#39;u&#39;, &#39;v&#39;), 66),
 ((&#39;u&#39;, &#39;g&#39;), 65),
 ((&#39;a&#39;, &#39;h&#39;), 64),
 ((&#39;r&#39;, &#39;r&#39;), 64),
 ((&#39;g&#39;, &#39;l&#39;), 63),
 ((&#39;u&#39;, &#39;f&#39;), 59),
 ((&#39;w&#39;, &#39;i&#39;), 59),
 ((&#39;l&#39;, &#39;g&#39;), 57),
 ((&#39;v&#39;, &#39;o&#39;), 57),
 ((&#39;o&#39;, &#39;e&#39;), 57),
 ((&#39;w&#39;, &#39;e&#39;), 56),
 ((&#39;e&#39;, &#39;y&#39;), 56),
 ((&#39;h&#39;, &#39;u&#39;), 53),
 ((&#39;m&#39;, &#39;p&#39;), 53),
 ((&#39;n&#39;, &#39;f&#39;), 53),
 ((&#39;n&#39;, &#39;r&#39;), 52),
 ((&#39;y&#39;, &#39;n&#39;), 51),
 ((&#39;u&#39;, &#39;z&#39;), 51),
 ((&#39;i&#39;, &#39;u&#39;), 50),
 ((&#39;y&#39;, &#39;d&#39;), 49),
 ((&#39;j&#39;, &#39;i&#39;), 48),
 ((&#39;y&#39;, &#39;e&#39;), 47),
 ((&#39;s&#39;, &#39;s&#39;), 47),
 ((&#39;i&#39;, &#39;x&#39;), 45),
 ((&#39;a&#39;, &#39;a&#39;), 45),
 ((&#39;u&#39;, &#39;k&#39;), 45),
 ((&#39;i&#39;, &#39;j&#39;), 45),
 ((&#39;o&#39;, &#39;p&#39;), 43),
 ((&#39;r&#39;, &#39;y&#39;), 42),
 ((&#39;a&#39;, &#39;k&#39;), 42),
 ((&#39;&lt;I&gt;&#39;, &#39;q&#39;), 41),
 ((&#39;y&#39;, &#39;r&#39;), 40),
 ((&#39;e&#39;, &#39;e&#39;), 39),
 ((&#39;s&#39;, &#39;z&#39;), 39),
 ((&#39;u&#39;, &#39;&lt;F&gt;&#39;), 38),
 ((&#39;b&#39;, &#39;d&#39;), 37),
 ((&#39;o&#39;, &#39;u&#39;), 37),
 ((&#39;n&#39;, &#39;k&#39;), 37),
 ((&#39;i&#39;, &#39;q&#39;), 34),
 ((&#39;o&#39;, &#39;a&#39;), 34),
 ((&#39;e&#39;, &#39;x&#39;), 34),
 ((&#39;f&#39;, &#39;u&#39;), 34),
 ((&#39;t&#39;, &#39;s&#39;), 34),
 ((&#39;d&#39;, &#39;m&#39;), 34),
 ((&#39;d&#39;, &#39;y&#39;), 34),
 ((&#39;n&#39;, &#39;y&#39;), 33),
 ((&#39;x&#39;, &#39;t&#39;), 33),
 ((&#39;p&#39;, &#39;l&#39;), 33),
 ((&#39;n&#39;, &#39;j&#39;), 32),
 ((&#39;u&#39;, &#39;p&#39;), 32),
 ((&#39;k&#39;, &#39;&lt;F&gt;&#39;), 32),
 ((&#39;p&#39;, &#39;p&#39;), 32),
 ((&#39;c&#39;, &#39;&lt;F&gt;&#39;), 31),
 ((&#39;u&#39;, &#39;o&#39;), 31),
 ((&#39;s&#39;, &#39;v&#39;), 30),
 ((&#39;p&#39;, &#39;u&#39;), 30),
 ((&#39;k&#39;, &#39;e&#39;), 30),
 ((&#39;a&#39;, &#39;w&#39;), 30),
 ((&#39;i&#39;, &#39;y&#39;), 28),
 ((&#39;e&#39;, &#39;q&#39;), 28),
 ((&#39;g&#39;, &#39;&lt;F&gt;&#39;), 27),
 ((&#39;y&#39;, &#39;m&#39;), 27),
 ((&#39;a&#39;, &#39;j&#39;), 27),
 ((&#39;g&#39;, &#39;d&#39;), 25),
 ((&#39;o&#39;, &#39;y&#39;), 25),
 ((&#39;o&#39;, &#39;q&#39;), 24),
 ((&#39;o&#39;, &#39;k&#39;), 24),
 ((&#39;o&#39;, &#39;j&#39;), 24),
 ((&#39;y&#39;, &#39;u&#39;), 23),
 ((&#39;w&#39;, &#39;&lt;F&gt;&#39;), 22),
 ((&#39;x&#39;, &#39;e&#39;), 22),
 ((&#39;e&#39;, &#39;k&#39;), 22),
 ((&#39;r&#39;, &#39;p&#39;), 21),
 ((&#39;o&#39;, &#39;h&#39;), 21),
 ((&#39;s&#39;, &#39;f&#39;), 21),
 ((&#39;k&#39;, &#39;u&#39;), 21),
 ((&#39;f&#39;, &#39;&lt;F&gt;&#39;), 20),
 ((&#39;c&#39;, &#39;y&#39;), 20),
 ((&#39;s&#39;, &#39;b&#39;), 20),
 ((&#39;m&#39;, &#39;m&#39;), 19),
 ((&#39;l&#39;, &#39;k&#39;), 19),
 ((&#39;l&#39;, &#39;p&#39;), 19),
 ((&#39;n&#39;, &#39;q&#39;), 19),
 ((&#39;d&#39;, &#39;d&#39;), 19),
 ((&#39;y&#39;, &#39;l&#39;), 18),
 ((&#39;t&#39;, &#39;y&#39;), 18),
 ((&#39;x&#39;, &#39;&lt;F&gt;&#39;), 17),
 ((&#39;r&#39;, &#39;z&#39;), 17),
 ((&#39;n&#39;, &#39;v&#39;), 17),
 ((&#39;o&#39;, &#39;z&#39;), 17),
 ((&#39;u&#39;, &#39;h&#39;), 17),
 ((&#39;v&#39;, &#39;l&#39;), 17),
 ((&#39;d&#39;, &#39;g&#39;), 16),
 ((&#39;u&#39;, &#39;j&#39;), 16),
 ((&#39;r&#39;, &#39;q&#39;), 16),
 ((&#39;b&#39;, &#39;&lt;F&gt;&#39;), 16),
 ((&#39;y&#39;, &#39;g&#39;), 16),
 ((&#39;m&#39;, &#39;y&#39;), 15),
 ((&#39;e&#39;, &#39;h&#39;), 15),
 ((&#39;l&#39;, &#39;z&#39;), 15),
 ((&#39;s&#39;, &#39;r&#39;), 14),
 ((&#39;d&#39;, &#39;w&#39;), 14),
 ((&#39;z&#39;, &#39;y&#39;), 14),
 ((&#39;d&#39;, &#39;v&#39;), 14),
 ((&#39;c&#39;, &#39;c&#39;), 14),
 ((&#39;i&#39;, &#39;h&#39;), 14),
 ((&#39;r&#39;, &#39;k&#39;), 14),
 ((&#39;r&#39;, &#39;j&#39;), 14),
 ((&#39;r&#39;, &#39;w&#39;), 13),
 ((&#39;p&#39;, &#39;c&#39;), 12),
 ((&#39;e&#39;, &#39;w&#39;), 12),
 ((&#39;h&#39;, &#39;r&#39;), 12),
 ((&#39;c&#39;, &#39;z&#39;), 12),
 ((&#39;j&#39;, &#39;z&#39;), 12),
 ((&#39;v&#39;, &#39;&lt;F&gt;&#39;), 12),
 ((&#39;n&#39;, &#39;m&#39;), 11),
 ((&#39;w&#39;, &#39;o&#39;), 11),
 ((&#39;s&#39;, &#39;y&#39;), 11),
 ((&#39;p&#39;, &#39;h&#39;), 11),
 ((&#39;z&#39;, &#39;m&#39;), 11),
 ((&#39;w&#39;, &#39;l&#39;), 11),
 ((&#39;u&#39;, &#39;y&#39;), 11),
 ((&#39;s&#39;, &#39;q&#39;), 11),
 ((&#39;g&#39;, &#39;m&#39;), 10),
 ((&#39;p&#39;, &#39;&lt;F&gt;&#39;), 10),
 ((&#39;l&#39;, &#39;q&#39;), 10),
 ((&#39;z&#39;, &#39;z&#39;), 10),
 ((&#39;y&#39;, &#39;i&#39;), 10),
 ((&#39;h&#39;, &#39;t&#39;), 9),
 ((&#39;t&#39;, &#39;l&#39;), 9),
 ((&#39;k&#39;, &#39;l&#39;), 9),
 ((&#39;x&#39;, &#39;a&#39;), 9),
 ((&#39;z&#39;, &#39;d&#39;), 9),
 ((&#39;s&#39;, &#39;k&#39;), 8),
 ((&#39;d&#39;, &#39;l&#39;), 8),
 ((&#39;c&#39;, &#39;q&#39;), 8),
 ((&#39;k&#39;, &#39;s&#39;), 8),
 ((&#39;s&#39;, &#39;d&#39;), 8),
 ((&#39;r&#39;, &#39;h&#39;), 8),
 ((&#39;d&#39;, &#39;z&#39;), 8),
 ((&#39;v&#39;, &#39;r&#39;), 7),
 ((&#39;k&#39;, &#39;r&#39;), 7),
 ((&#39;l&#39;, &#39;j&#39;), 7),
 ((&#39;g&#39;, &#39;h&#39;), 7),
 ((&#39;p&#39;, &#39;s&#39;), 6),
 ((&#39;f&#39;, &#39;f&#39;), 6),
 ((&#39;o&#39;, &#39;w&#39;), 6),
 ((&#39;d&#39;, &#39;n&#39;), 6),
 ((&#39;s&#39;, &#39;w&#39;), 6),
 ((&#39;v&#39;, &#39;k&#39;), 6),
 ((&#39;h&#39;, &#39;y&#39;), 6),
 ((&#39;s&#39;, &#39;n&#39;), 6),
 ((&#39;b&#39;, &#39;s&#39;), 6),
 ((&#39;y&#39;, &#39;w&#39;), 6),
 ((&#39;c&#39;, &#39;k&#39;), 5),
 ((&#39;y&#39;, &#39;t&#39;), 5),
 ((&#39;l&#39;, &#39;w&#39;), 5),
 ((&#39;g&#39;, &#39;g&#39;), 5),
 ((&#39;z&#39;, &#39;r&#39;), 5),
 ((&#39;j&#39;, &#39;n&#39;), 5),
 ((&#39;d&#39;, &#39;h&#39;), 5),
 ((&#39;l&#39;, &#39;h&#39;), 5),
 ((&#39;z&#39;, &#39;c&#39;), 5),
 ((&#39;t&#39;, &#39;m&#39;), 5),
 ((&#39;j&#39;, &#39;g&#39;), 4),
 ((&#39;u&#39;, &#39;x&#39;), 4),
 ((&#39;f&#39;, &#39;g&#39;), 4),
 ((&#39;h&#39;, &#39;n&#39;), 4),
 ((&#39;l&#39;, &#39;n&#39;), 4),
 ((&#39;m&#39;, &#39;s&#39;), 4),
 ((&#39;t&#39;, &#39;k&#39;), 4),
 ((&#39;j&#39;, &#39;l&#39;), 4),
 ((&#39;t&#39;, &#39;z&#39;), 4),
 ((&#39;x&#39;, &#39;c&#39;), 4),
 ((&#39;y&#39;, &#39;b&#39;), 4),
 ((&#39;h&#39;, &#39;d&#39;), 4),
 ((&#39;h&#39;, &#39;m&#39;), 4),
 ((&#39;g&#39;, &#39;t&#39;), 4),
 ((&#39;n&#39;, &#39;l&#39;), 4),
 ((&#39;n&#39;, &#39;h&#39;), 4),
 ((&#39;m&#39;, &#39;n&#39;), 4),
 ((&#39;i&#39;, &#39;w&#39;), 4),
 ((&#39;g&#39;, &#39;w&#39;), 3),
 ((&#39;j&#39;, &#39;&lt;F&gt;&#39;), 3),
 ((&#39;j&#39;, &#39;k&#39;), 3),
 ((&#39;w&#39;, &#39;d&#39;), 3),
 ((&#39;p&#39;, &#39;t&#39;), 3),
 ((&#39;h&#39;, &#39;l&#39;), 3),
 ((&#39;y&#39;, &#39;c&#39;), 3),
 ((&#39;z&#39;, &#39;b&#39;), 3),
 ((&#39;l&#39;, &#39;r&#39;), 3),
 ((&#39;n&#39;, &#39;b&#39;), 3),
 ((&#39;u&#39;, &#39;q&#39;), 3),
 ((&#39;g&#39;, &#39;f&#39;), 3),
 ((&#39;y&#39;, &#39;f&#39;), 3),
 ((&#39;w&#39;, &#39;y&#39;), 3),
 ((&#39;y&#39;, &#39;v&#39;), 3),
 ((&#39;t&#39;, &#39;n&#39;), 3),
 ((&#39;z&#39;, &#39;h&#39;), 3),
 ((&#39;t&#39;, &#39;j&#39;), 2),
 ((&#39;v&#39;, &#39;u&#39;), 2),
 ((&#39;v&#39;, &#39;d&#39;), 2),
 ((&#39;j&#39;, &#39;m&#39;), 2),
 ((&#39;k&#39;, &#39;y&#39;), 2),
 ((&#39;b&#39;, &#39;b&#39;), 2),
 ((&#39;d&#39;, &#39;j&#39;), 2),
 ((&#39;z&#39;, &#39;t&#39;), 2),
 ((&#39;y&#39;, &#39;p&#39;), 2),
 ((&#39;d&#39;, &#39;k&#39;), 2),
 ((&#39;v&#39;, &#39;y&#39;), 2),
 ((&#39;w&#39;, &#39;k&#39;), 2),
 ((&#39;m&#39;, &#39;r&#39;), 2),
 ((&#39;t&#39;, &#39;b&#39;), 2),
 ((&#39;g&#39;, &#39;y&#39;), 2),
 ((&#39;u&#39;, &#39;u&#39;), 2),
 ((&#39;t&#39;, &#39;v&#39;), 2),
 ((&#39;x&#39;, &#39;p&#39;), 2),
 ((&#39;m&#39;, &#39;g&#39;), 2),
 ((&#39;n&#39;, &#39;w&#39;), 2),
 ((&#39;v&#39;, &#39;h&#39;), 2),
 ((&#39;i&#39;, &#39;i&#39;), 2),
 ((&#39;j&#39;, &#39;w&#39;), 2),
 ((&#39;f&#39;, &#39;t&#39;), 2),
 ((&#39;g&#39;, &#39;b&#39;), 2),
 ((&#39;z&#39;, &#39;l&#39;), 2),
 ((&#39;b&#39;, &#39;y&#39;), 2),
 ((&#39;j&#39;, &#39;s&#39;), 2),
 ((&#39;j&#39;, &#39;d&#39;), 2),
 ((&#39;m&#39;, &#39;h&#39;), 2),
 ((&#39;o&#39;, &#39;x&#39;), 2),
 ((&#39;d&#39;, &#39;t&#39;), 2),
 ((&#39;q&#39;, &#39;i&#39;), 1),
 ((&#39;j&#39;, &#39;r&#39;), 1),
 ((&#39;v&#39;, &#39;v&#39;), 1),
 ((&#39;d&#39;, &#39;s&#39;), 1),
 ((&#39;m&#39;, &#39;d&#39;), 1),
 ((&#39;m&#39;, &#39;l&#39;), 1),
 ((&#39;b&#39;, &#39;h&#39;), 1),
 ((&#39;z&#39;, &#39;n&#39;), 1),
 ((&#39;j&#39;, &#39;y&#39;), 1),
 ((&#39;t&#39;, &#39;w&#39;), 1),
 ((&#39;k&#39;, &#39;k&#39;), 1),
 ((&#39;h&#39;, &#39;w&#39;), 1),
 ((&#39;c&#39;, &#39;s&#39;), 1),
 ((&#39;f&#39;, &#39;n&#39;), 1),
 ((&#39;n&#39;, &#39;p&#39;), 1),
 ((&#39;f&#39;, &#39;c&#39;), 1),
 ((&#39;d&#39;, &#39;f&#39;), 1),
 ((&#39;k&#39;, &#39;c&#39;), 1),
 ((&#39;g&#39;, &#39;j&#39;), 1),
 ((&#39;c&#39;, &#39;n&#39;), 1),
 ((&#39;g&#39;, &#39;v&#39;), 1),
 ((&#39;t&#39;, &#39;c&#39;), 1),
 ((&#39;m&#39;, &#39;t&#39;), 1),
 ((&#39;f&#39;, &#39;q&#39;), 1),
 ((&#39;h&#39;, &#39;s&#39;), 1),
 ((&#39;y&#39;, &#39;x&#39;), 1),
 ((&#39;z&#39;, &#39;v&#39;), 1),
 ((&#39;p&#39;, &#39;z&#39;), 1),
 ((&#39;k&#39;, &#39;m&#39;), 1),
 ((&#39;y&#39;, &#39;z&#39;), 1),
 ((&#39;j&#39;, &#39;v&#39;), 1),
 ((&#39;p&#39;, &#39;y&#39;), 1),
 ((&#39;v&#39;, &#39;s&#39;), 1),
 ((&#39;y&#39;, &#39;k&#39;), 1),
 ((&#39;b&#39;, &#39;j&#39;), 1),
 ((&#39;s&#39;, &#39;g&#39;), 1),
 ((&#39;k&#39;, &#39;n&#39;), 1),
 ((&#39;m&#39;, &#39;f&#39;), 1),
 ((&#39;z&#39;, &#39;k&#39;), 1),
 ((&#39;w&#39;, &#39;b&#39;), 1),
 ((&#39;w&#39;, &#39;j&#39;), 1),
 ((&#39;v&#39;, &#39;n&#39;), 1),
 ((&#39;g&#39;, &#39;z&#39;), 1),
 ((&#39;t&#39;, &#39;x&#39;), 1),
 ((&#39;x&#39;, &#39;u&#39;), 1),
 ((&#39;t&#39;, &#39;d&#39;), 1),
 ((&#39;j&#39;, &#39;t&#39;), 1)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">27</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">caracs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">palabras</span><span class="p">))))</span>

<span class="n">paf</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span><span class="n">f</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">caracs</span><span class="p">)}</span>
<span class="n">paf</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fap</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="p">:</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">f</span> <span class="ow">in</span> <span class="n">paf</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">paf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: 1,
 &#39;b&#39;: 2,
 &#39;c&#39;: 3,
 &#39;d&#39;: 4,
 &#39;e&#39;: 5,
 &#39;f&#39;: 6,
 &#39;g&#39;: 7,
 &#39;h&#39;: 8,
 &#39;i&#39;: 9,
 &#39;j&#39;: 10,
 &#39;k&#39;: 11,
 &#39;l&#39;: 12,
 &#39;m&#39;: 13,
 &#39;n&#39;: 14,
 &#39;o&#39;: 15,
 &#39;p&#39;: 16,
 &#39;q&#39;: 17,
 &#39;r&#39;: 18,
 &#39;s&#39;: 19,
 &#39;t&#39;: 20,
 &#39;u&#39;: 21,
 &#39;v&#39;: 22,
 &#39;w&#39;: 23,
 &#39;x&#39;: 24,
 &#39;y&#39;: 25,
 &#39;z&#39;: 26,
 &#39;.&#39;: 0}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: &#39;a&#39;,
 2: &#39;b&#39;,
 3: &#39;c&#39;,
 4: &#39;d&#39;,
 5: &#39;e&#39;,
 6: &#39;f&#39;,
 7: &#39;g&#39;,
 8: &#39;h&#39;,
 9: &#39;i&#39;,
 10: &#39;j&#39;,
 11: &#39;k&#39;,
 12: &#39;l&#39;,
 13: &#39;m&#39;,
 14: &#39;n&#39;,
 15: &#39;o&#39;,
 16: &#39;p&#39;,
 17: &#39;q&#39;,
 18: &#39;r&#39;,
 19: &#39;s&#39;,
 20: &#39;t&#39;,
 21: &#39;u&#39;,
 22: &#39;v&#39;,
 23: &#39;w&#39;,
 24: &#39;x&#39;,
 25: &#39;y&#39;,
 26: &#39;z&#39;,
 0: &#39;.&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palabras</span><span class="p">:</span>
  <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c2</span><span class="p">]</span>
    <span class="n">N</span><span class="p">[</span><span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">27</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">27</span><span class="p">):</span>
    <span class="n">cts</span> <span class="o">=</span> <span class="n">fap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">fap</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">cts</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/hacedor_14_0.png" src="_images/hacedor_14_0.png" />
</div>
</div>
<p>Hemos contado la ocurrencia de cada bigrama en el documento de nombres. Ahora, podemos utilizar este conteo como una distribución de probabilidades acerca de cuál letra debe ser consecutiva con otra. Ejemplifiquemos con una fila:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># first row</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([   0, 2611,  909, 1465, 1038, 2205,  941,  924,  668,  726,  522,   88,
        1230, 1228,  913,  584,  774,   41, 1014, 1248,  578,  154,  548,  169,
           0,  218,  233], dtype=torch.int32)
</pre></div>
</div>
</div>
</div>
<p>Obtendremos las probabilidades de cada valor al dividir cada uno por la sumatoria de todos. Con este truco, todos los valores sumados nos darán 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([0.0000, 0.1242, 0.0432, 0.0697, 0.0494, 0.1049, 0.0447, 0.0439, 0.0318,
        0.0345, 0.0248, 0.0042, 0.0585, 0.0584, 0.0434, 0.0278, 0.0368, 0.0019,
        0.0482, 0.0593, 0.0275, 0.0073, 0.0261, 0.0080, 0.0000, 0.0104, 0.0111])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor(1.0000)
</pre></div>
</div>
</div>
</div>
<p>Utilizaremos <code class="docutils literal notranslate"><span class="pre">torch.multinomial</span></code> para generar números enteros con base en las probabilidades de la distribución que creamos. Primero veamos un ejemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#creamos tres valores aleatorios</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># ahora, creamos una distribución con base en ellos</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([0.1805, 0.2687, 0.5233])
tensor([0.1856, 0.2763, 0.5381])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># ahora tomamos muestras de números enteros con base en la distribución</span>
<span class="c1"># Notemos que los números generados reflejan la distribución de probabilidades anteriores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 2, 1, 1, 2, 0, 0, 2, 1, 2])
</pre></div>
</div>
</div>
</div>
<p>Ahora podemos hacer lo mismo con la primera fila:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">torch</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1])
</pre></div>
</div>
</div>
</div>
<p>Pero el resultado obtenido es el índice de la letra. Veámoslo como letra:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">ejemplo</span> <span class="o">=</span> <span class="n">fap</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<span class="n">ejemplo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;b&#39;
</pre></div>
</div>
</div>
</div>
<p>Ahora haremos lo mismo con todos los bigramas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="c1"># agregamos 1 al conteo para que el logaritmo no tenga problemas eventualmente (smoothing)</span>
<span class="n">P</span> <span class="o">/=</span> <span class="n">P</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># el 1 indica que la sumatoria se hace en la dimensión 1 (las columnas colapsan para sumarse)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">P</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor(1.0000), torch.Size([27, 27]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([4.7492e-05, 1.2405e-01, 4.3218e-02, 6.9624e-02, 4.9345e-02, 1.0477e-01,
        4.4738e-02, 4.3930e-02, 3.1772e-02, 3.4527e-02, 2.4839e-02, 4.2268e-03,
        5.8463e-02, 5.8368e-02, 4.3408e-02, 2.7783e-02, 3.6807e-02, 1.9947e-03,
        4.8205e-02, 5.9318e-02, 2.7498e-02, 7.3613e-03, 2.6073e-02, 8.0737e-03,
        4.7492e-05, 1.0401e-02, 1.1113e-02])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
  <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">ix</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
    <span class="n">ix</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fap</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">break</span>
    
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>erauia.
eriobrgibelargra.
eondima.
salidolia.
ger.
</pre></div>
</div>
</div>
</div>
<p>Podemos observar las probabilidades asignadas a cada bigrama:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palabras</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
  <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c2</span><span class="p">]</span> 
    <span class="n">prob</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">c1</span><span class="si">}{</span><span class="n">c2</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.m: 0.0584
ma: 0.3492
ar: 0.0863
ri: 0.2349
ia: 0.1907
a.: 0.4568
.r: 0.0482
ro: 0.1212
os: 0.0515
sa: 0.1840
a.: 0.4568
.j: 0.0248
jo: 0.2045
os: 0.0515
se: 0.1236
e.: 0.0674
</pre></div>
</div>
</div>
</div>
<p>Dado que altas probabilidades en nuestros bigramas indican buen «aprendizaje», en el sentido de que nuestro modelo no es completamente aleatorio, sino que concede importancia a bigramas apropiadamente, una estimación de precisión que podemos emplear es la máxima verosimilitud (maximum likelihood), que es el resultado de multiplicar todas las probabilidades. Por conveniencia, esta estimación utiliza el logaritmo natural de las probabilidades: sumar los logaritmos de las probabilidades es equivalente a multiplicar las probabilidades.</p>
<p>El logaritmo del 0 al uno presenta como valor máximo al 0, pero como valor mínimo el infinito:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: RuntimeWarning: divide by zero encountered in log
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fecef4f0d50&gt;]
</pre></div>
</div>
<img alt="_images/hacedor_36_2.png" src="_images/hacedor_36_2.png" />
</div>
</div>
<p>Pero, dado que quisiéramos números positivos, podemos volver positivo este número:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logprob</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="n">nlog</span> <span class="o">=</span> <span class="o">-</span><span class="n">logprob</span>
<span class="n">logprob</span><span class="p">,</span> <span class="n">nlog</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor(-2.6971), tensor(2.6971))
</pre></div>
</div>
</div>
</div>
<p>Y la negative log likelihood es la suma de todas las negative logs. Nuestra loss function entonces podría ser la negative log likelihood (<code class="docutils literal notranslate"><span class="pre">nll</span></code>) normalizada para obtener el promedio. Mientras esta loss function sea menor, nuestro modelo será mejor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">log_likelihood</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palabras</span><span class="p">:</span>
  <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c2</span><span class="p">]</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span><span class="p">]</span>
    <span class="n">logprob</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
    <span class="n">log_likelihood</span> <span class="o">+=</span> <span class="n">logprob</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1">#print(f&#39;{c1}{c2}: {prob} {log_likelihood:.4f}&#39;)</span>

<span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="n">log_likelihood</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">nll</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">nll</span><span class="o">/</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>375152.34375
2.2672061920166016
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">log_likelihood</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="k">for</span> <span class="n">bi</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;dante&#39;</span><span class="p">]:</span>
  <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">bi</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c2</span><span class="p">]</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">ix1</span><span class="p">,</span><span class="n">ix2</span><span class="p">]</span>
    <span class="n">logprob</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
    <span class="n">log_likelihood</span> <span class="o">+=</span> <span class="n">logprob</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">c1</span><span class="si">}{</span><span class="n">c2</span><span class="si">}</span><span class="s1"> | prob: </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s1">.7f</span><span class="si">}</span><span class="s1"> | log likelihood: </span><span class="si">{</span><span class="n">log_likelihood</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="n">log_likelihood</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;nll: </span><span class="si">{</span><span class="n">nll</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;loss fn: </span><span class="si">{</span><span class="n">nll</span><span class="o">/</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.d | prob: 0.0493446 | log likelihood: -3.0089
da | prob: 0.3054336 | log likelihood: -4.1949
an | prob: 0.1229762 | log likelihood: -6.2907
nt | prob: 0.0515025 | log likelihood: -9.2568
te | prob: 0.1527994 | log likelihood: -11.1355
e. | prob: 0.0674018 | log likelihood: -13.8326
nll: 13.832551956176758
loss fn: 2.3054254055023193
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="red-neuronal">
<h1>RED NEURONAL<a class="headerlink" href="#red-neuronal" title="Permalink to this headline">#</a></h1>
<p>Optimizaremos nuestro modelo con una red neuronal:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Juntaremos los bigramas para el set de entrenamiento (inputs x, predicciones y)</span>
<span class="c1"># Primero un ejemplo:</span>

<span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palabras</span><span class="p">[:</span><span class="mi">1</span><span class="p">]:</span>
  <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c2</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
    <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix1</span><span class="p">)</span>
    <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix2</span><span class="p">)</span>

<span class="n">xs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">ys</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>. m
m a
a r
r i
i a
a .
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([ 0, 13,  1, 18,  9,  1]), tensor([13,  1, 18,  9,  1,  0]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ahora todas las palabras</span>

<span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">palabras</span><span class="p">:</span>
  <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">paf</span><span class="p">[</span><span class="n">c2</span><span class="p">]</span>
    <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix1</span><span class="p">)</span>
    <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix2</span><span class="p">)</span>

<span class="n">xs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="c1"># Pasamos cada bigrama a tensores x (inputs), y (predicción deseada)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
<span class="n">xs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([ 0, 13,  1,  ..., 12, 12,  1])
</pre></div>
</div>
</div>
</div>
<p>Para pasar esta información a una red neuronal, primero la codificaremos en vectores vía one-hot encoding:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="c1"># Primero veamos un ejemplo:</span>
<span class="n">xenc</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">xenc</span><span class="p">,</span> <span class="n">xenc</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([ 0, 13,  1, 18,  9,  1]),
 tensor([[1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
          0., 0., 0., 0., 0., 0., 0., 0., 0.],
         [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
          0., 0., 0., 0., 0., 0., 0., 0., 0.],
         [0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
          0., 0., 0., 0., 0., 0., 0., 0., 0.],
         [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
          1., 0., 0., 0., 0., 0., 0., 0., 0.],
         [0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
          0., 0., 0., 0., 0., 0., 0., 0., 0.],
         [0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
          0., 0., 0., 0., 0., 0., 0., 0., 0.]]),
 torch.Size([6, 27]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">xenc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7fecefcab610&gt;
</pre></div>
</div>
<img alt="_images/hacedor_48_1.png" src="_images/hacedor_48_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xenc</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="c1"># Ahora hacemos un one-hot encoding con todos los datos</span>
<span class="n">xenc</span><span class="p">,</span> <span class="n">xenc</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([[1., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 1., 0.,  ..., 0., 0., 0.],
         ...,
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 0., 0.,  ..., 0., 0., 0.],
         [0., 1., 0.,  ..., 0., 0., 0.]]), torch.Size([165469, 27]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">27</span><span class="p">,</span><span class="mi">27</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">xenc</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">w</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="n">xenc</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">@</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[ 1.7375e+00, -1.6226e+00,  1.1169e+00,  5.2440e-01,  1.9235e+00,
          7.7240e-02,  9.0700e-01, -1.4147e-02, -1.3114e+00,  1.8893e+00,
          1.3329e+00,  3.8851e-01,  1.4112e-03, -6.9552e-01,  1.5654e+00,
         -1.1414e+00, -3.3127e-01,  1.6875e+00, -3.0902e-01, -2.8625e-01,
          3.0215e-02, -4.3973e-01,  9.5093e-01, -8.3326e-01,  3.8003e-01,
         -4.0360e-01,  9.7218e-01],
        [-4.0560e-01,  1.1065e-01, -2.0732e-01, -3.5821e-01, -1.7004e+00,
         -4.6233e-02,  4.6964e-01, -4.7488e-01, -1.1909e-01,  7.0113e-01,
          4.0031e-02, -4.9382e-01,  1.1622e+00, -1.3650e+00, -9.1052e-01,
         -2.0342e+00, -1.5120e+00, -4.5619e-01, -2.3238e-01, -1.4177e+00,
          5.8740e-01, -2.1195e+00, -2.9052e-01, -6.9798e-01, -5.4531e-02,
          2.6171e-01, -2.9523e-01],
        [ 1.8342e+00, -4.6852e-01,  1.3385e+00, -1.4190e+00,  5.9264e-01,
         -1.0697e+00, -3.2573e-01,  4.0733e-01, -2.4890e-01,  1.7361e+00,
          2.8319e-03, -2.0055e+00,  4.2760e-01,  6.9175e-01,  5.9975e-01,
          8.7237e-01, -6.3227e-01, -1.2790e-01, -1.3292e+00, -8.1998e-01,
         -1.5152e+00, -1.0235e+00, -1.4560e+00,  3.3558e-01,  4.2188e-01,
          3.1603e-01,  2.7001e-01],
        [-1.1373e+00, -1.1675e+00, -1.6936e+00, -1.3474e-02, -2.1573e+00,
          1.0019e+00, -1.8112e-01, -3.7313e-01, -4.1062e-02,  9.7716e-01,
         -9.6486e-01,  5.1369e-02,  9.7147e-01, -1.8224e+00,  1.1882e+00,
         -2.7321e-01, -8.2738e-01, -8.7574e-01,  5.5597e-01,  5.9345e-01,
          1.9153e+00, -9.8067e-01, -2.9926e-01,  4.4905e-01,  1.8059e-02,
         -8.0995e-01, -1.0276e+00],
        [-1.2791e+00, -1.0225e+00, -6.8597e-01, -1.0755e+00,  3.7567e-01,
          7.7221e-01, -3.3079e-01,  7.6159e-01,  8.0750e-01, -4.7380e-01,
          4.1898e-01, -1.4381e+00, -1.1769e+00,  4.2931e-01,  1.0825e+00,
          8.9465e-01,  1.7487e+00,  1.3802e+00,  1.6745e+00, -4.3801e-01,
          1.3424e+00,  2.4644e-02,  3.1259e+00, -1.8899e+00,  9.7181e-01,
          1.3974e+00,  7.4278e-01],
        [ 1.8342e+00, -4.6852e-01,  1.3385e+00, -1.4190e+00,  5.9264e-01,
         -1.0697e+00, -3.2573e-01,  4.0733e-01, -2.4890e-01,  1.7361e+00,
          2.8319e-03, -2.0055e+00,  4.2760e-01,  6.9175e-01,  5.9975e-01,
          8.7237e-01, -6.3227e-01, -1.2790e-01, -1.3292e+00, -8.1998e-01,
         -1.5152e+00, -1.0235e+00, -1.4560e+00,  3.3558e-01,  4.2188e-01,
          3.1603e-01,  2.7001e-01]], grad_fn=&lt;MmBackward0&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xenc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([-1.6226, -0.4685,  0.2680,  1.0141, -0.2838,  0.2251,  0.6496, -1.0305,
        -1.0217, -1.0225,  0.5276, -1.1557,  1.2544,  0.1107, -0.2494,  0.3028,
         1.3921, -1.9678, -1.1675, -0.2656,  0.7018,  2.0679,  1.9240, -0.7715,
         0.0897,  1.8722,  1.2221], grad_fn=&lt;SelectBackward0&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">xenc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([-1.6226, -0.0000,  0.0000,  0.0000, -0.0000,  0.0000,  0.0000, -0.0000,
        -0.0000, -0.0000,  0.0000, -0.0000,  0.0000,  0.0000, -0.0000,  0.0000,
         0.0000, -0.0000, -0.0000, -0.0000,  0.0000,  0.0000,  0.0000, -0.0000,
         0.0000,  0.0000,  0.0000], grad_fn=&lt;MulBackward0&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">xenc</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">@</span> <span class="n">w</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor(-1.6226, grad_fn=&lt;SelectBackward0&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">xenc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor(-1.6226, grad_fn=&lt;SumBackward0&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#FORWARD PASS</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">27</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Creamos weights aleatorios</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">xenc</span> <span class="o">@</span> <span class="n">W</span> <span class="c1">#multiplicamos valores de x por w para obtener log-counts</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span> <span class="c1"># exponenciamos para obtener valores mayores a 0, equivalentes a matriz N</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># normalizar los counts para obtener probabilidades</span>
<span class="n">probs</span> <span class="c1"># los últimos dos pasos son equivalentes a la función softmax</span>
<span class="n">logits</span><span class="o">.</span><span class="n">shape</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([165469, 27])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">probs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([165469, 27])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">probs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([0.0146, 0.0240, 0.0170, 0.0048, 0.0505, 0.0098, 0.1241, 0.0519, 0.0512,
        0.0357, 0.0390, 0.0099, 0.0302, 0.0544, 0.0401, 0.0584, 0.0268, 0.0211,
        0.0679, 0.0421, 0.0178, 0.0231, 0.0844, 0.0066, 0.0394, 0.0392, 0.0163],
       grad_fn=&lt;SelectBackward0&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nlls</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;bigrama ejemplo </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">fap</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}{</span><span class="n">fap</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="si">}</span><span class="s1">, índices </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;input: </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;probabilidad del output, calculado por la red neuronal: </span><span class="si">{</span><span class="n">probs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output correcto: </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">probs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;probabilidad asignada por la red al caracter correcto: </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="n">logp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;log likelihood&#39;</span><span class="p">,</span> <span class="n">logp</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
  <span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="n">logp</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;negative log likelihood:&#39;</span><span class="p">,</span> <span class="n">nll</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
  <span class="n">nlls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nll</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;promedio de la nll, i. e. loss = </span><span class="si">{</span><span class="n">nlls</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------
bigrama ejemplo 1: .m, índices 0,13
input: 0
probabilidad del output, calculado por la red neuronal: tensor([0.0146, 0.0240, 0.0170, 0.0048, 0.0505, 0.0098, 0.1241, 0.0519, 0.0512,
        0.0357, 0.0390, 0.0099, 0.0302, 0.0544, 0.0401, 0.0584, 0.0268, 0.0211,
        0.0679, 0.0421, 0.0178, 0.0231, 0.0844, 0.0066, 0.0394, 0.0392, 0.0163],
       grad_fn=&lt;SelectBackward0&gt;)
output correcto: 13
probabilidad asignada por la red al caracter correcto: 0.054369036108255386
log likelihood -2.9119603633880615
negative log likelihood: 2.9119603633880615
------
bigrama ejemplo 2: ma, índices 13,1
input: 13
probabilidad del output, calculado por la red neuronal: tensor([0.0190, 0.0084, 0.0094, 0.0123, 0.0760, 0.0291, 0.0261, 0.0591, 0.0548,
        0.0536, 0.0354, 0.0165, 0.0473, 0.0186, 0.0016, 0.0602, 0.0484, 0.2626,
        0.0251, 0.0171, 0.0043, 0.0247, 0.0068, 0.0103, 0.0107, 0.0571, 0.0055],
       grad_fn=&lt;SelectBackward0&gt;)
output correcto: 1
probabilidad asignada por la red al caracter correcto: 0.008444707840681076
log likelihood -4.774215221405029
negative log likelihood: 4.774215221405029
------
bigrama ejemplo 3: ar, índices 1,18
input: 1
probabilidad del output, calculado por la red neuronal: tensor([0.0105, 0.0074, 0.1967, 0.0444, 0.0483, 0.0106, 0.0260, 0.1063, 0.0099,
        0.0076, 0.0055, 0.0040, 0.0316, 0.0381, 0.0075, 0.0147, 0.0141, 0.1226,
        0.0064, 0.0166, 0.0194, 0.0242, 0.0382, 0.1326, 0.0259, 0.0064, 0.0246],
       grad_fn=&lt;SelectBackward0&gt;)
output correcto: 18
probabilidad asignada por la red al caracter correcto: 0.0064162202179431915
log likelihood -5.048925876617432
negative log likelihood: 5.048925876617432
------
bigrama ejemplo 4: ri, índices 18,9
input: 18
probabilidad del output, calculado por la red neuronal: tensor([0.0095, 0.0282, 0.0058, 0.1280, 0.0144, 0.0868, 0.0343, 0.0071, 0.1516,
        0.0194, 0.0119, 0.0588, 0.0142, 0.0143, 0.0650, 0.0127, 0.0032, 0.0203,
        0.0337, 0.0228, 0.0651, 0.0232, 0.0180, 0.0074, 0.0153, 0.0097, 0.1192],
       grad_fn=&lt;SelectBackward0&gt;)
output correcto: 9
probabilidad asignada por la red al caracter correcto: 0.019440125674009323
log likelihood -3.940416097640991
negative log likelihood: 3.940416097640991
------
bigrama ejemplo 5: ia, índices 9,1
input: 9
probabilidad del output, calculado por la red neuronal: tensor([0.0251, 0.0070, 0.0123, 0.1168, 0.0567, 0.0249, 0.0779, 0.0102, 0.0246,
        0.0103, 0.0183, 0.0747, 0.0065, 0.0576, 0.0100, 0.0353, 0.0363, 0.0152,
        0.0735, 0.0478, 0.0073, 0.0619, 0.0161, 0.0192, 0.0172, 0.0610, 0.0762],
       grad_fn=&lt;SelectBackward0&gt;)
output correcto: 1
probabilidad asignada por la red al caracter correcto: 0.0070234667509794235
log likelihood -4.958498477935791
negative log likelihood: 4.958498477935791
------
bigrama ejemplo 6: a., índices 1,0
input: 1
probabilidad del output, calculado por la red neuronal: tensor([0.0105, 0.0074, 0.1967, 0.0444, 0.0483, 0.0106, 0.0260, 0.1063, 0.0099,
        0.0076, 0.0055, 0.0040, 0.0316, 0.0381, 0.0075, 0.0147, 0.0141, 0.1226,
        0.0064, 0.0166, 0.0194, 0.0242, 0.0382, 0.1326, 0.0259, 0.0064, 0.0246],
       grad_fn=&lt;SelectBackward0&gt;)
output correcto: 0
probabilidad asignada por la red al caracter correcto: 0.01051294058561325
log likelihood -4.555148124694824
negative log likelihood: 4.555148124694824
-----
promedio de la nll, i. e. loss = 4.364860534667969
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([ 0, 13,  1,  ..., 12, 12,  1])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([13,  1, 18,  ..., 12,  1,  0])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">probs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">probs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">18</span><span class="p">],</span> <span class="n">probs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="n">probs</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">probs</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor(0.0544, grad_fn=&lt;SelectBackward0&gt;),
 tensor(0.0084, grad_fn=&lt;SelectBackward0&gt;),
 tensor(0.0064, grad_fn=&lt;SelectBackward0&gt;),
 tensor(0.0194, grad_fn=&lt;SelectBackward0&gt;),
 tensor(0.0070, grad_fn=&lt;SelectBackward0&gt;),
 tensor(0.0105, grad_fn=&lt;SelectBackward0&gt;))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor(702.6670, grad_fn=&lt;SumBackward0&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># AHORA TODO JUNTO:</span>

<span class="n">num</span> <span class="o">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">nelement</span><span class="p">()</span>

<span class="c1"># FORWARD PASS</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="n">xenc</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="c1"># Ahora hacemos un one-hot encoding</span>
  <span class="n">logits</span> <span class="o">=</span> <span class="n">xenc</span> <span class="o">@</span> <span class="n">W</span> <span class="c1">#multiplicamos valores de x por w para obtener log-counts</span>
  <span class="n">counts</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span> <span class="c1"># exponenciamos para obtener valores mayores a 0, equivalentes a matriz N</span>
  <span class="n">probs</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># normalizar los counts para obtener probabilidades</span>
  <span class="n">probs</span> <span class="c1"># los últimos dos pasos son equivalentes a la función softmax</span>
  <span class="n">loss</span> <span class="o">=</span> <span class="o">-</span><span class="n">probs</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">ys</span><span class="p">]</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
  
  <span class="c1"># BACKWARD PASS</span>
  <span class="n">W</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

  <span class="c1"># UPDATE</span>
  <span class="n">W</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">50</span> <span class="o">*</span> <span class="n">W</span><span class="o">.</span><span class="n">grad</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.4221291542053223
2.337578296661377
2.320709705352783
2.315040111541748
2.3112778663635254
2.3103187084198
2.3092570304870605
2.308797836303711
2.3081626892089844
2.307844877243042
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
  <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">ix</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">xenc</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">ix</span><span class="p">]),</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">xenc</span> <span class="o">@</span> <span class="n">W</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="n">ix</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fap</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">break</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>celdino.
a.
sminoferiludaderta.
cis.
vada.
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dante Noguez<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>