

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Elementos de redes neuronales &#8212; Dantis Elementorum</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-C9T8ZX64EM"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-C9T8ZX64EM');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/alfa/redes';</script>
    <link rel="canonical" href="https://dantenoguez.github.io/notebooks/alfa/redes.html" />
    <link rel="shortcut icon" href="../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Elementos de cálculo infinitesimal" href="calculo.html" />
    <link rel="prev" title="Elementos de programación" href="programacion.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Dantis Elementorum
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Elementorum Physicæ Mathematicæ</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="programacion.html">Elementos de programación</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Elementos de redes neuronales</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculo.html">Elementos de cálculo infinitesimal</a></li>
<li class="toctree-l1"><a class="reference internal" href="hacedor.html">Elementos de procesamiento de lenguajes naturales, o El Hacedor</a></li>
<li class="toctree-l1"><a class="reference internal" href="hacedor2.html">Elementos de procesamiento de lenguajes naturales, parte II</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitalbio.html">Elementos de biología digital</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Elementorum Politicæ Œconomicæ Iurisprudentiæ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../beta/iurisprudentiae.html">Elementos de leyes, o Nova methodus discendæ iurisprudentiæ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beta/schumpeter.html">Notas a Schumpeter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Elementorum Poeticæ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../poeticae/borges.html">Elementos de literatura borgesiana, o Borges y sus precursores</a></li>
<li class="toctree-l1"><a class="reference internal" href="../poeticae/afro.html">Elementos de música afroamericana</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exagium</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../exagium/tzompantli.html">Breve ensayo sobre el tzompantli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exagium/diccionario.html">Diccionario fantástico de la lengua española</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exagium/escribir.html">Escribir ¿para qué?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exagium/secturnial.html">Relatos secturniales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exagium/castillos.html">La importancia de ser olvidado</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exagium/aforismos.html">Cuaderno de notas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exagium/ia.html">Tientos cibernéticos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exagium/coronavirus.html">Bitácora del confinamiento</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/DanteNoguez/Ensayos" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/DanteNoguez/Ensayos/issues/new?title=Issue%20on%20page%20%2Fnotebooks/alfa/redes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/alfa/redes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Elementos de redes neuronales</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#la-derivada-demostrada-segun-el-orden-geometrico">La derivada demostrada según el orden geométrico</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pero-para-que-sirve-la-derivada">Pero ¿para qué sirve la derivada?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pequegrad">Pequegrad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#la-regla-de-la-cadena-propagacion-hacia-atras">La regla de la cadena: propagación hacia atrás</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perceptron-multicapa">Perceptrón multicapa</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bibliografia-recomendada">Bibliografía recomendada</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="elementos-de-redes-neuronales">
<h1>Elementos de redes neuronales<a class="headerlink" href="#elementos-de-redes-neuronales" title="Permalink to this heading">#</a></h1>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p><em>Como prerrequisitos para esta lección, sugiero leer la <a class="reference external" href="https://dantenoguez.github.io/notebooks/alfa/programacion.html">lección anterior</a> y el artículo de Khan Academy sobre la <a class="reference external" href="https://es.khanacademy.org/math/cc-eighth-grade-math/cc-8th-linear-equations-functions/8th-slope/a/slope-from-two-points">pendiente matemática</a>.</em></p>
</aside>
<p>Este ensayo está inspirado en <a class="reference external" href="https://github.com/karpathy/micrograd">micrograd</a> de Andrej Karpathy. A continuación, construiremos una red neuronal desde cero, explicando a detalle cada uno de sus elementos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!pip install matplotlib --upgrade
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<section id="la-derivada-demostrada-segun-el-orden-geometrico">
<h2>La derivada demostrada según el orden geométrico<a class="headerlink" href="#la-derivada-demostrada-segun-el-orden-geometrico" title="Permalink to this heading">#</a></h2>
<p>Las redes neuronales son gigantescas funciones matemáticas. La característica distintiva de estas funciones, que catalizan gran parte de lo que hoy se denomina «inteligencia artificial» (aunque, más estrictamente, deberíamos hablar de «aprendizaje profundo» o <em>deep learning</em>), es que pueden «aprender» a refinar, optimizar y generalizar las «reglas» (parámetros) que las componen. Tal proceso de aprendizaje consiste en la iteración de operaciones matemáticas propias del cálculo diferencial y vectorial. Por ello, para poder formular una red neuronal, procuraremos primero entender intuitivamente a la derivada: esa médula matemática del aprendizaje.</p>
<p>Para tal propósito, construiremos la derivada desde cero, utilizando apenas unas cuantas nociones básicas de geometría.</p>
<p>En geometría, denominamos «pendiente» al valor de la inclinación de una recta. Conceptualmente, la pendiente puede ser interpretada como la proporción del cambio que hay entre las variables <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span> de la recta. En otras palabras, la pendiente mide qué tanto influye <span class="math notranslate nohighlight">\(x\)</span> en el valor de <span class="math notranslate nohighlight">\(y\)</span>, o qué tanto cambia <span class="math notranslate nohighlight">\(y\)</span> cuando avanzamos en <span class="math notranslate nohighlight">\(x\)</span>. Supongamos, por ejemplo, la recta de una función que podemos definir como <span class="math notranslate nohighlight">\(f(x, b) = x \cdot b\)</span>, donde:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">b</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Valores de b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;Valores de y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">}</span>
<span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">tabla</span> <span class="o">=</span> <span class="n">tabla</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">hide_index</span><span class="p">()</span>
<span class="n">tabla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_aa72e_" class="dataframe">
  <thead>
    <tr>
      <th class="col_heading level0 col0" >Valores de x</th>
      <th class="col_heading level0 col1" >Valores de b</th>
      <th class="col_heading level0 col2" >Valores de y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_aa72e_row0_col0" class="data row0 col0" >0</td>
      <td id="T_aa72e_row0_col1" class="data row0 col1" >5</td>
      <td id="T_aa72e_row0_col2" class="data row0 col2" >0</td>
    </tr>
    <tr>
      <td id="T_aa72e_row1_col0" class="data row1 col0" >2</td>
      <td id="T_aa72e_row1_col1" class="data row1 col1" >5</td>
      <td id="T_aa72e_row1_col2" class="data row1 col2" >10</td>
    </tr>
    <tr>
      <td id="T_aa72e_row2_col0" class="data row2 col0" >4</td>
      <td id="T_aa72e_row2_col1" class="data row2 col1" >5</td>
      <td id="T_aa72e_row2_col2" class="data row2 col2" >20</td>
    </tr>
    <tr>
      <td id="T_aa72e_row3_col0" class="data row3 col0" >6</td>
      <td id="T_aa72e_row3_col1" class="data row3 col1" >5</td>
      <td id="T_aa72e_row3_col2" class="data row3 col2" >30</td>
    </tr>
    <tr>
      <td id="T_aa72e_row4_col0" class="data row4 col0" >8</td>
      <td id="T_aa72e_row4_col1" class="data row4 col1" >5</td>
      <td id="T_aa72e_row4_col2" class="data row4 col2" >40</td>
    </tr>
    <tr>
      <td id="T_aa72e_row5_col0" class="data row5 col0" >10</td>
      <td id="T_aa72e_row5_col1" class="data row5 col1" >5</td>
      <td id="T_aa72e_row5_col2" class="data row5 col2" >50</td>
    </tr>
    <tr>
      <td id="T_aa72e_row6_col0" class="data row6 col0" >12</td>
      <td id="T_aa72e_row6_col1" class="data row6 col1" >5</td>
      <td id="T_aa72e_row6_col2" class="data row6 col2" >60</td>
    </tr>
    <tr>
      <td id="T_aa72e_row7_col0" class="data row7 col0" >14</td>
      <td id="T_aa72e_row7_col1" class="data row7 col1" >5</td>
      <td id="T_aa72e_row7_col2" class="data row7 col2" >70</td>
    </tr>
    <tr>
      <td id="T_aa72e_row8_col0" class="data row8 col0" >16</td>
      <td id="T_aa72e_row8_col1" class="data row8 col1" >5</td>
      <td id="T_aa72e_row8_col2" class="data row8 col2" >80</td>
    </tr>
    <tr>
      <td id="T_aa72e_row9_col0" class="data row9 col0" >18</td>
      <td id="T_aa72e_row9_col1" class="data row9 col1" >5</td>
      <td id="T_aa72e_row9_col2" class="data row9 col2" >90</td>
    </tr>
    <tr>
      <td id="T_aa72e_row10_col0" class="data row10 col0" >20</td>
      <td id="T_aa72e_row10_col1" class="data row10 col1" >5</td>
      <td id="T_aa72e_row10_col2" class="data row10 col2" >100</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>En términos más simples, la función es una multiplicación entre <span class="math notranslate nohighlight">\(x\)</span> (números del <span class="math notranslate nohighlight">\(0\)</span> al <span class="math notranslate nohighlight">\(20\)</span> en intervalos de <span class="math notranslate nohighlight">\(2\)</span>) y <span class="math notranslate nohighlight">\(b\)</span> (es decir, <span class="math notranslate nohighlight">\(5\)</span>). Podemos visualizarla de la siguiente manera:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/83de4665974c3cf8aa3acc9da3cad4a38d8e1947ad7b168c5c58deed7c6d5bdc.png" src="../../_images/83de4665974c3cf8aa3acc9da3cad4a38d8e1947ad7b168c5c58deed7c6d5bdc.png" />
</div>
</div>
<p>Ahora, ¿cómo puedo saber cuánto está influyendo cada valor de <span class="math notranslate nohighlight">\(x\)</span> en cada valor de <span class="math notranslate nohighlight">\(y\)</span>? Es decir, si paso de <span class="math notranslate nohighlight">\(x=2\)</span> a <span class="math notranslate nohighlight">\(x=4\)</span>, ¿qué le pasa a <span class="math notranslate nohighlight">\(y\)</span>? <span class="math notranslate nohighlight">\(y\)</span> avanza desde <span class="math notranslate nohighlight">\(10\)</span> hasta <span class="math notranslate nohighlight">\(20\)</span>, es decir, cinco veces <span class="math notranslate nohighlight">\(x\)</span>: <span class="math notranslate nohighlight">\(5 \times 2 = 10\)</span>. Y si paso de <span class="math notranslate nohighlight">\(x=4\)</span> a <span class="math notranslate nohighlight">\(x=6\)</span>, es decir, si avanzo dos «pasos» en <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> nuevamente avanza cinco veces lo que avancé en <span class="math notranslate nohighlight">\(x\)</span>, pasando de <span class="math notranslate nohighlight">\(20\)</span> a <span class="math notranslate nohighlight">\(30\)</span>.</p>
<p>En ese sentido, la proporción que hay entre <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span> es de <span class="math notranslate nohighlight">\(5\)</span>, <span class="math notranslate nohighlight">\(5\)</span> es el número que determina cada valor de <span class="math notranslate nohighlight">\(y\)</span> a partir de <span class="math notranslate nohighlight">\(x\)</span> o, dicho de otra forma, <span class="math notranslate nohighlight">\(5\)</span> es la «fuerza» con la que <span class="math notranslate nohighlight">\(x\)</span> influye en <span class="math notranslate nohighlight">\(y\)</span>. Esta intuición es clave, pero al mismo tiempo resulta evidente porque la definición de mi función —o sea, cada valor de <span class="math notranslate nohighlight">\(y\)</span>— indica que debo multiplicar <span class="math notranslate nohighlight">\(x\)</span> por <span class="math notranslate nohighlight">\(5\)</span>. Al calcular la pendiente, es como si no supiéramos este número y tuviéramos que deducirlo matemáticamente.</p>
<p>La fórmula de la pendiente nos ofrece un método general para calcular esta proporción o fuerza de la que hablamos:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los símbolos <span class="math notranslate nohighlight">\(\Delta, \delta\)</span> son letras del alfabeta griego llamadas «delta», y generalmente se utilizan en matemáticas para representar o leer un cambio: «cambio en <span class="math notranslate nohighlight">\(y\)</span> sobre cambio en <span class="math notranslate nohighlight">\(x\)</span>».</p>
</aside>
<div class="math notranslate nohighlight">
\[
Pendiente = \frac{y_2 - y_1}{x_2 - x_1} = \frac{\Delta y}{\Delta x}
\]</div>
<p>Entonces la fórmula solo nos dice que debemos tomar dos puntos cualesquiera de <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span> para calcular la pendiente. Por ejemplo, si consideramos los valores del punto denotado por las líneas punteadas en la gráfica anterior, de tal manera que <span class="math notranslate nohighlight">\(x_1 = 2, y_1 = 10\)</span>, podemos tomar el punto siguiente para calcular la pendiente o inclinación de la recta, de manera que:</p>
<div class="math notranslate nohighlight">
\[
Pendiente = \frac{20 - 10}{4 - 2} = \frac{10}{2} = 5
\]</div>
<p>Pero las funciones lineales —es decir, las rectas—, por definición tienen la misma inclinación en todos sus puntos o segmentos. Comprobémoslo cambiando nuestras <span class="math notranslate nohighlight">\(x_2, y_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[
Pendiente = \frac{y_2 - y_1}{x_2 - x_1} = \frac{60 - 10}{12 - 2} = \frac{50}{10} = 5
\]</div>
<p>Naturalmente, la pendiente sigue siendo la misma. Ahora reiteremos, ¿exactamente qué quiere decir el número cinco? Que por cada paso que damos en <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> avanza cinco veces más. Dicho de otra forma, <span class="math notranslate nohighlight">\(y\)</span> es el resultado de multiplicar <span class="math notranslate nohighlight">\(x\)</span> por cinco; o <span class="math notranslate nohighlight">\(x\)</span> influye con una «fuerza» de cinco veces sí misma en <span class="math notranslate nohighlight">\(y\)</span>; o <span class="math notranslate nohighlight">\(x\)</span> transforma a <span class="math notranslate nohighlight">\(y\)</span> con una fuerza de cinco veces sí misma.</p>
<p>Visualicemos la pendiente en color rojo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Valor de la pendiente: </span><span class="si">{</span><span class="n">pendiente</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;recta de la función&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de y&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span> <span class="n">slope</span><span class="o">=</span><span class="n">pendiente</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pendiente&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valor de la pendiente: 5.0
</pre></div>
</div>
<img alt="../../_images/b8c65436183dd53125284f131aabecdc2793046d526bc7162d9dd26009045014.png" src="../../_images/b8c65436183dd53125284f131aabecdc2793046d526bc7162d9dd26009045014.png" />
</div>
</div>
<p>La pendiente es idéntica a la recta porque, como decíamos, la recta tiene la misma inclinación —pendiente— en todos sus puntos. Ahora, el problema con la pendiente es que esta propiedad es al mismo tiempo una limitación fundamental: la pendiente solo es válida para una recta o función lineal.</p>
<p>Dado que las funciones no lineales no tienen la misma inclinación en todos sus puntos, no podemos hablar de la «inclinación» ni de la «pendiente de una función no lineal». Visualicémoslo con una función cuadrática, donde mis valores de <span class="math notranslate nohighlight">\(x\)</span> ahora van del <span class="math notranslate nohighlight">\(0\)</span> al <span class="math notranslate nohighlight">\(5.99\)</span>. Digamos también que me interesa saber la inclinación o «pendiente» de la función cuando <span class="math notranslate nohighlight">\(x=5\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">nolineal</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">nolineal</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">pendiente</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gráfica de la función&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="n">pendiente</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pendiente?&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6e3b35a5c9c6202da51c3362206f7684b9afdb8a71e2b7ec2209bdb39a5bc46b.png" src="../../_images/6e3b35a5c9c6202da51c3362206f7684b9afdb8a71e2b7ec2209bdb39a5bc46b.png" />
</div>
</div>
<p>Para calcular la inclinación de la función (es decir, la curva azul) cuando <span class="math notranslate nohighlight">\(x=5\)</span>, he utilizado la fórmula de la pendiente tomando como referencia los puntos <span class="math notranslate nohighlight">\(x_1=2, x_2=5\)</span>, de tal manera que:</p>
<div class="math notranslate nohighlight">
\[
Pendiente = \frac{y_2 - y_1}{x_2 - x_1} = \frac{25 - 4}{5 - 2} = \frac{21}{3} = 7
\]</div>
<p>Pero la realidad es que mi función no cambió en esa proporción con respecto al punto <span class="math notranslate nohighlight">\(x=5\)</span>: esa pendiente de <span class="math notranslate nohighlight">\(7\)</span> corresponde a la secante<a class="footnote-reference brackets" href="#id5" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> que atraviesa la función, no a la «pendiente» del punto <span class="math notranslate nohighlight">\(x=5\)</span>. La gráfica evidencia que el resultado es inexacto: queda claro que la función tiene una inclinación distinta a la de la recta roja.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Tengamos en mente lo siguiente: nuestra función es curva porque su inclinación siempre cambia, y su inclinación siempre cambia porque cada valor de <span class="math notranslate nohighlight">\(x\)</span> influye en <span class="math notranslate nohighlight">\(y\)</span> de manera distinta. Intuitivamente, cuando <span class="math notranslate nohighlight">\(x=4\)</span>, <span class="math notranslate nohighlight">\(y\)</span> resulta de <span class="math notranslate nohighlight">\(4^2\)</span>, es decir, <span class="math notranslate nohighlight">\(y\)</span> resulta de multiplicar <span class="math notranslate nohighlight">\(4 \times 4\)</span>; pero cuando <span class="math notranslate nohighlight">\(x=5\)</span>, <span class="math notranslate nohighlight">\(y\)</span> aumenta en una proporción diferente: <span class="math notranslate nohighlight">\(5 \times 5\)</span>. Por contra, las rectas o funciones lineales siempre cambian en la misma proporción —anteriormente, siempre se multiplicaba cada <span class="math notranslate nohighlight">\(x\)</span> por <span class="math notranslate nohighlight">\(5\)</span>—, de manera que su inclinación es única y constante.</p>
</aside>
<p>Además de que la función tiene múltiples «pendientes» —porque su inclinación siempre cambia—, estas «pendientes» son inexactas, puesto que no miden con precisión el impacto (o inclinación) de un solo punto en la función, sino que la fórmula de la pendiente necesariamente nos ofrece la inclinación de una recta trazada entre dos valores de <span class="math notranslate nohighlight">\(x\)</span> y dos valores de <span class="math notranslate nohighlight">\(y\)</span>. Puesto que la función con la que lidiamos ahora es curva, los puntos de <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span> que tomamos no son satisfactorios porque denotan una línea, no una curva. En ese sentido, el resultado está sesgado.</p>
<p>Entonces, ¿cómo puedo hacer para encontrar el verdadero impacto de <span class="math notranslate nohighlight">\(x\)</span> en <span class="math notranslate nohighlight">\(y\)</span>? Podemos pensar en el siguiente truco: si la pendiente de la secante, aunque errónea, se acerca de alguna forma a nuestro valor deseado, ¿no podríamos hacer una secante más pequeña, tal que fuera más similar al punto que nos interesa? Es decir, si tomáramos la pendiente de la distancia entre dos puntos de <span class="math notranslate nohighlight">\(x\)</span> más cercanos entre sí, eso tendría que darnos una mejor aproximación al resultado correcto, ¿no? Veámoslo así:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Valor de la pendiente con una secante más pequeña: </span><span class="si">{</span><span class="n">pendiente</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gráfica de la función&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de y / f(x)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="n">pendiente</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pendiente?&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gráfica de la función&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de y / f(x)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Zoom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="n">pendiente</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pendiente?&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valor de la pendiente con una secante más pequeña: 9.0
</pre></div>
</div>
<img alt="../../_images/8a1ba7a697012e7333a878585e69f8ca9cc154d059df4aa43b2839d7446ff6b5.png" src="../../_images/8a1ba7a697012e7333a878585e69f8ca9cc154d059df4aa43b2839d7446ff6b5.png" />
</div>
</div>
<p>Gráficamente podemos comprobar que hemos obtenido un mucho mejor resultado: la secante que trazamos tiene una inclinación similar a la de la curva de la función. Pero las líneas punteadas —las cuales denotan los puntos que hemos tomado como referencia para calcular la pendiente— nos indican que todavía podemos mejorar, tomando como referencia coordenadas más cercanas entre sí.</p>
<p>Bien, pues antes de continuar experimentando, adelantemos ya que esta línea de razonamiento es precisamente la que dio origen a la derivada. El truco es este: podemos calcular la pendiente de líneas secantes cada vez más pequeñas y similares a nuestro punto, obteniendo cada vez mejores resultados. Es más, podemos llegar a calcular la pendiente de una línea infinitamente pequeña, tan pequeña que sería casi idéntica al punto, y la pendiente de esa línea infinitamente pequeña sería igual a la pendiente del punto. En ese mismo sentido, podríamos decir incluso —y de hecho se hace así en el ámbito matemático— que estamos calculando la pendiente de una línea tangente al punto, puesto que su pendiente sería igual a la de una secante infinitamente pequeña que se confunde con el punto.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Hasta donde sé, fue Leibniz quien inventó la derivada razonando de una manera <a class="reference external" href="https://youtu.be/5M2RWtD4EzI">casi idéntica</a> a la nuestra.</p>
</aside>
<figure class="align-default" id="derivada">
<a class="reference internal image-reference" href="../../_images/derivada.png"><img alt="../../_images/derivada.png" src="../../_images/derivada.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Como en la imagen, queremos obtener la pendiente de una secante cada vez más pequeña —más cercana al punto que nos interesa—, es decir, con una distancia <span class="math notranslate nohighlight">\(h\)</span> cada vez menor. Podemos hacer esta línea tan infinitamente pequeña que se identifique con el punto; por tanto, su pendiente sería igual a la pendiente de una línea tangente al punto.</span><a class="headerlink" href="#derivada" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Utilizando la fórmula de la pendiente para poner en práctica nuestra intuición, podemos conseguir un resultado como este:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">4.99</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mf">4.99</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Valor de la pendiente con una secante más pequeña: </span><span class="si">{</span><span class="n">pendiente</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gráfica de la función&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de y / f(x)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="n">pendiente</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pendiente?&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">4.99</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">4.99</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">4.99</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">4.99</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gráfica de la función&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de y / f(x)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Zoom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="n">pendiente</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pendiente?&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">4.99</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">4.99</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">4.99</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">4.99</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valor de la pendiente con una secante más pequeña: 9.990000000000023
</pre></div>
</div>
<img alt="../../_images/beaf72a4871ea88918f0d1ecd521e2063bdaf30876bfb4d09067f64291797899.png" src="../../_images/beaf72a4871ea88918f0d1ecd521e2063bdaf30876bfb4d09067f64291797899.png" />
</div>
</div>
<p>En esencia, hemos minimizado las distancias entre <span class="math notranslate nohighlight">\(x_2\)</span> y <span class="math notranslate nohighlight">\(x_1\)</span> al utilizar los valores <span class="math notranslate nohighlight">\(x_2=5, x_1=4.99\)</span> para obtener un resultado más riguroso. Gráficamente, corroboramos que nuestro resultado es más exacto: la línea que podemos trazar con la pendiente obtenida es casi idéntica a la función, al punto que la opaca cuando la miramos desde cerca. Suponiendo, como en nuestro dibujo anterior, que llamemos <span class="math notranslate nohighlight">\(h\)</span> a la distancia entre las <span class="math notranslate nohighlight">\(x\)</span>, nuestra fórmula actual para la pendiente de esta tangente o secante infinitamente pequeña luce así:</p>
<div class="math notranslate nohighlight">
\[
Pendiente = \frac{y_2 - y_1}{x_2 - x_1} = \frac{f(x+h) - f(x)}{(x+h) - x} = \frac{f(x+h) - f(x)}{h}
\]</div>
<p>Como decía, idealmente queremos que la distancia <span class="math notranslate nohighlight">\(h\)</span> sea lo más pequeña posible, es decir, lo más cercana a <span class="math notranslate nohighlight">\(0\)</span> posible (sin ser <span class="math notranslate nohighlight">\(0\)</span>, puesto que necesitamos una distancia entre dos <span class="math notranslate nohighlight">\(x\)</span> para tener una línea y así ser capaces de obtener su pendiente, puesto que un punto no tiene pendiente). Para expresar esta idea, emplearemos la expresión <span class="math notranslate nohighlight">\(\lim _{h \rightarrow 0}\)</span>, es decir, «cuando <span class="math notranslate nohighlight">\(h\)</span> es tan pequeña que se acerca a <span class="math notranslate nohighlight">\(0\)</span>» o, más estrictamente, «el límite de la función cuando <span class="math notranslate nohighlight">\(h\)</span> tiende a <span class="math notranslate nohighlight">\(0\)</span>». De tal manera que:</p>
<div class="math notranslate nohighlight">
\[
\lim _{h \rightarrow 0} \frac{f(x+h) - f(x)}{h}
\]</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Sobre límites se puede leer <a class="reference external" href="https://es.khanacademy.org/math/ap-calculus-ab/ab-limits-new/ab-1-2/a/limits-intro?modal=1">este artículo</a>; sobre derivadas, <a class="reference external" href="https://es.khanacademy.org/math/ap-calculus-ab/ab-differentiation-1-new">son recomendables también estos videos</a>.</p>
</aside>
<p>Pero ahora ya no hablamos de una pendiente exactamente, sino que la estamos alterando para conseguir un resultado distinto. A este nuevo concepto lo denominaremos «derivada»:</p>
<div class="math notranslate nohighlight">
\[
Derivada = \lim _{h \rightarrow 0} \frac{f(x+h) - f(x)}{h}
\]</div>
<p>En la práctica también suele escribirse como <span class="math notranslate nohighlight">\(\frac{dy}{dx}\)</span>, o <span class="math notranslate nohighlight">\(f'(x)\)</span>.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Bien vista, la expresión <span class="math notranslate nohighlight">\(\frac{dy}{dx}\)</span> ilustra a la perfección el concepto: estamos midiendo la diferencia en el valor de <span class="math notranslate nohighlight">\(y\)</span> (<span class="math notranslate nohighlight">\(dy\)</span>) que provoca un cambio infinitamente pequeño en la variable <span class="math notranslate nohighlight">\(x\)</span>, es decir, una pequeña diferencia —denotada por <span class="math notranslate nohighlight">\(h\)</span>— en <span class="math notranslate nohighlight">\(x\)</span>: <span class="math notranslate nohighlight">\(dx\)</span>. Finalmente, para averiguar la proporción que guardan entre ellos, los dividimos entre sí, midiendo la derivada —diferencia— de <span class="math notranslate nohighlight">\(y\)</span> con respecto a <span class="math notranslate nohighlight">\(x\)</span> —es decir, con respecto a una pequeña diferencia en el valor de <span class="math notranslate nohighlight">\(x\)</span>. El nombre «cálculo diferencial» viene precisamente de la medición de esas pequeñas diferencias en los valores de las variables.</p>
</aside>
<p>Aplicada a nuestro problema, podemos utilizarla así:</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dx} =\lim _{h \rightarrow 0} \frac{f(x+h) - f(x)}{h} = \frac{(5+0.001)^2 - 5^2}{0.001} = 10.00
\]</div>
<p>Programáticamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">derivada</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
  <span class="n">h</span> <span class="o">=</span> <span class="mf">0.001</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">h</span>

<span class="n">derivada</span><span class="p">(</span><span class="n">nolineal</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.001000000002591
</pre></div>
</div>
</div>
</div>
<p>Finalmente hemos descubierto que cuando <span class="math notranslate nohighlight">\(x=5\)</span>, <span class="math notranslate nohighlight">\(x\)</span> «influye» en <span class="math notranslate nohighlight">\(y\)</span> con una «fuerza» de <span class="math notranslate nohighlight">\(10\)</span>. Analíticamente, podemos comprobarlo de esta forma:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather*}
\frac{dy}{dx} =\lim _{h \rightarrow 0} \frac{(x+h)^2 - x^2}{h} = \lim _{h \rightarrow 0} \frac{(x+h)(x+h) - 2x}{h} = \lim _{h \rightarrow 0} \frac{2x + xh + hx + 2h - 2x}{h} \\
= \lim _{h \rightarrow 0} \frac{2xh + 2h}{h} = \lim _{h \rightarrow 0} \frac{h(2x + h)}{h} = \lim _{h \rightarrow 0} 2x + h = 2x + 0 = 2x
\end{gather*}
\end{split}\]</div>
<p>Ahora, podemos generalizar esta expresión bajo la fórmula <span class="math notranslate nohighlight">\(nx^{n-1}\)</span>, es decir, cuando <span class="math notranslate nohighlight">\(f(x) = x^2\)</span> y <span class="math notranslate nohighlight">\(x=5\)</span>, entonces:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather*}
2x = 2(5) = 10 \\
nx^{n-1} = 2(5)^{2-1} = 10
\end{gather*}
\end{split}\]</div>
<p>En suma, <span class="math notranslate nohighlight">\(10\)</span> es efectivamente la proporción o fuerza con la que <span class="math notranslate nohighlight">\(x\)</span> influye en <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(10\)</span> es la derivada de <span class="math notranslate nohighlight">\(y\)</span> con respecto a <span class="math notranslate nohighlight">\(x\)</span> cuando <span class="math notranslate nohighlight">\(x=5\)</span>. Y, según hemos visto, podemos obtener este resultado de formas distintas: aplicando la fórmula, programáticamente, geométricamente y analítica o algebraicamente. En general, toda fórmula o expresión matemática tiene un trasfondo racional como los que hemos llevado a cabo, aunque las más de las veces se requieren algunos desarrollos lógico-matemáticos ulteriores para generalizarlas.</p>
<p>Volviendo a lo nuestro, podemos concluir que, conceptualmente, la derivada —igual que la pendiente— mide la <strong>proporción o magnitud del cambio</strong> que una variable provoca en el resultado de una función. Digamos que la derivada mide la fuerza con la que una variable influye —en un determinado punto— en el resultado de una función.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>En rigor, la derivada no solo se diferencia de la pendiente por referirse a funciones no lineales, sino también porque es útil para medir el impacto que diferentes variables tienen en una función compuesta (es decir, en una función de más de dos dimensiones o variables). Esto lo veremos más adelante, sin embargo, es importante ser conscientes de que nuestra formulación geométrica de la derivada es una manera intuitiva —y legítima en términos históricos— de entenderla, pero su concepto puede ampliarse a problemas, funciones y dimensiones más complejas que son difíciles de visualizar.</p>
</aside>
<p>Pongamos otro ejemplo: si los valores de la función nunca cambiaran, entonces su derivada sería <span class="math notranslate nohighlight">\(0\)</span>. Geométricamente, no habría nada de inclinación en la tangente a cualquier punto de la función; conceptualmente, la definición de la función indicaría que su resultado nunca cambia: ninguna variable tendría influencia en la función, de manera que el «cambio» siempre sería nulo, cero.</p>
<p>Supongamos que quiero medir la distancia que recorro en <span class="math notranslate nohighlight">\(20\)</span> segundos: si con el paso del tiempo no avanzo nada o, lo que es lo mismo, si la variable tiempo no influye en la función distancia, entonces la función, la pendiente y la tangente a cualquier punto son <span class="math notranslate nohighlight">\(0\)</span>, por lo que lucen así:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tiempo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="k">return</span> <span class="n">t</span><span class="o">*</span><span class="mi">0</span>
<span class="n">distancia</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">tiempo</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tiempo</span><span class="p">,</span> <span class="n">distancia</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;recta de la función&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo (segundos)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Distancia (metros)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="n">tiempo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">distancia</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">slope</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;derivada / pendiente&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6957750a89c2e84e1c7e10fc4bbfc8a58d81833e9d4a0fa9d2c62c51b7860e0c.png" src="../../_images/6957750a89c2e84e1c7e10fc4bbfc8a58d81833e9d4a0fa9d2c62c51b7860e0c.png" />
</div>
</div>
<p>Veamos un último ejemplo, ahora con la función suma: mi variable <span class="math notranslate nohighlight">\(x\)</span> tendrá valores del <span class="math notranslate nohighlight">\(0\)</span> al <span class="math notranslate nohighlight">\(12\)</span> con intervalos de <span class="math notranslate nohighlight">\(2\)</span>, mientras que mi función es <span class="math notranslate nohighlight">\(x+6\)</span>. Mi tabla de valores entonces debería quedar así:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="mi">6</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Valores de y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">}</span>
<span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
<span class="n">tabla</span> <span class="o">=</span> <span class="n">tabla</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">hide_index</span><span class="p">()</span>
<span class="n">tabla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_c3ccb_" class="dataframe">
  <thead>
    <tr>
      <th class="col_heading level0 col0" >Valores de x</th>
      <th class="col_heading level0 col1" >Valores de y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_c3ccb_row0_col0" class="data row0 col0" >0</td>
      <td id="T_c3ccb_row0_col1" class="data row0 col1" >6</td>
    </tr>
    <tr>
      <td id="T_c3ccb_row1_col0" class="data row1 col0" >2</td>
      <td id="T_c3ccb_row1_col1" class="data row1 col1" >8</td>
    </tr>
    <tr>
      <td id="T_c3ccb_row2_col0" class="data row2 col0" >4</td>
      <td id="T_c3ccb_row2_col1" class="data row2 col1" >10</td>
    </tr>
    <tr>
      <td id="T_c3ccb_row3_col0" class="data row3 col0" >6</td>
      <td id="T_c3ccb_row3_col1" class="data row3 col1" >12</td>
    </tr>
    <tr>
      <td id="T_c3ccb_row4_col0" class="data row4 col0" >8</td>
      <td id="T_c3ccb_row4_col1" class="data row4 col1" >14</td>
    </tr>
    <tr>
      <td id="T_c3ccb_row5_col0" class="data row5 col0" >10</td>
      <td id="T_c3ccb_row5_col1" class="data row5 col1" >16</td>
    </tr>
    <tr>
      <td id="T_c3ccb_row6_col0" class="data row6 col0" >12</td>
      <td id="T_c3ccb_row6_col1" class="data row6 col1" >18</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Ahora preguntémonos: ¿en qué proporción cambia <span class="math notranslate nohighlight">\(y\)</span> cuando aumentamos <span class="math notranslate nohighlight">\(x\)</span>? Si paso de mi primer valor de <span class="math notranslate nohighlight">\(x\)</span> al segundo, es decir, si paso de <span class="math notranslate nohighlight">\(0\)</span> a <span class="math notranslate nohighlight">\(2\)</span>, ¿cuánto estoy aumentando a mi primer valor de <span class="math notranslate nohighlight">\(y\)</span>? ¡También dos! Es decir, que la proporción de los cambios entre <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span> es 1: si aumento dos a <span class="math notranslate nohighlight">\(x\)</span>, también aumento <span class="math notranslate nohighlight">\(2\)</span> a <span class="math notranslate nohighlight">\(y\)</span>. En nuestro primer ejemplo, si agregábamos <span class="math notranslate nohighlight">\(2\)</span> a <span class="math notranslate nohighlight">\(x\)</span>, nuestro valor de <span class="math notranslate nohighlight">\(y\)</span> aumentaba cinco veces <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Esto tiene sentido porque la multiplicación aumenta nuestros valores con mayor velocidad y en diferente proporción que la suma: por ejemplo, <span class="math notranslate nohighlight">\(2 \times 4 = 8\)</span>, pero <span class="math notranslate nohighlight">\(2 + 4 = 6\)</span>, y conforme tomamos números más grandes, nuestra multiplicación continúa creciendo a mayor velocidad que la suma: <span class="math notranslate nohighlight">\(2 \times 10 = 20\)</span>, pero <span class="math notranslate nohighlight">\(2 + 10 = 12\)</span>.</p>
<p>Grafiquemos nuestra nueva función de suma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">derivada</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;recta de la función&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valores de y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">slope</span><span class="o">=</span><span class="n">derivada</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;derivada / pendiente&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/497f99c4848de769f76752ec759b7db960d6366cff8fab48a4bbb3b64dbd6ca8.png" src="../../_images/497f99c4848de769f76752ec759b7db960d6366cff8fab48a4bbb3b64dbd6ca8.png" />
</div>
</div>
<p>La inclinación de la recta es menor porque <span class="math notranslate nohighlight">\(y\)</span> aumenta lentamente en proporción a <span class="math notranslate nohighlight">\(x\)</span>, de <span class="math notranslate nohighlight">\(2\)</span> en <span class="math notranslate nohighlight">\(2\)</span>. Una vez más: únicamente estamos averiguando la proporción que hay entre los valores de <span class="math notranslate nohighlight">\(x\)</span> y de <span class="math notranslate nohighlight">\(y\)</span>. Si cada valor de <span class="math notranslate nohighlight">\(x\)</span> aumenta significativamente cada valor correspondiente de la función, entonces nuestra derivada será alta y la inclinación de la recta será empinada.</p>
<p>Por otra parte, cuando cada valor de la función aumenta poco conforme hacemos más grande nuestra variable de entrada, entonces la derivada será pequeña y la inclinación será poca.</p>
</section>
<section id="pero-para-que-sirve-la-derivada">
<h2>Pero ¿para qué sirve la derivada?<a class="headerlink" href="#pero-para-que-sirve-la-derivada" title="Permalink to this heading">#</a></h2>
<p>Imaginemos que tenemos dos variables: <span class="math notranslate nohighlight">\(x = -2\)</span> y <span class="math notranslate nohighlight">\(y = 3\)</span>. La función <span class="math notranslate nohighlight">\(f(x, y)\)</span> las multiplica y su resultado es <span class="math notranslate nohighlight">\(-6\)</span>. Sin embargo, queremos alterar ese resultado para que sea <span class="math notranslate nohighlight">\(0\)</span> y tenemos una restricción: la única manera de hacerlo es a través de las variables de entrada. Para ello, podríamos pensar en aumentar o disminuir las entradas en pasos pequeños y probar aleatoriamente hasta conseguir el resultado.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ojo: disminuir el <span class="math notranslate nohighlight">\(3\)</span> aumenta el resultado, puesto que está siendo multiplicado por un número negativo. Ejemplo: <span class="math notranslate nohighlight">\(3-1 = 2, 2 \times -2 = -4\)</span>, y <span class="math notranslate nohighlight">\(-4\)</span> es mayor que <span class="math notranslate nohighlight">\(-6\)</span>, el resultado inicial.</p>
</aside>
<p>Supongamos que nuestro cambio aplicado será <span class="math notranslate nohighlight">\(0.01\)</span>: disminuiremos <span class="math notranslate nohighlight">\(y\)</span> en esa cantidad y aumentaremos <span class="math notranslate nohighlight">\(x\)</span> de la misma forma: <span class="math notranslate nohighlight">\(x = -1.99 \times y = 2.99 = -5.95\)</span>. Bien, <span class="math notranslate nohighlight">\(-5.95\)</span> es más cercano a <span class="math notranslate nohighlight">\(0\)</span> que <span class="math notranslate nohighlight">\(-6\)</span>. Podríamos continuar este proceso hasta llegar a <span class="math notranslate nohighlight">\(0\)</span>, pero nuestro método no parece muy efectivo.</p>
<p>Si recordamos la lección aprendida en las derivadas, se nos puede ocurrir utilizarlas para resolver este problema: dado que la derivada me dice el impacto que tiene una variable de entrada en la función, ¿será posible utilizarla para alterar el resultado de la función? Es decir, si la derivada me dice la magnitud del impacto que una varible tiene en el resultado, entonces debería poder utilizar esa información para influir en el resultado de manera más eficiente. Por ejemplo, si la derivada me indica que una variable influye positivamente en la función, pero yo quiero disminuirla, entonces sabré más o menos la magnitud en que debo disminuir esa variable, y así sucesivamente.</p>
</section>
<section id="pequegrad">
<h2>Pequegrad<a class="headerlink" href="#pequegrad" title="Permalink to this heading">#</a></h2>
<p>Para entender mejor la posible solución planteada, crearemos programáticamente la clase <code class="docutils literal notranslate"><span class="pre">Numero</span></code>, es decir, formularemos una estructura que nos permita definir, modificar y operar con números. De momento, cada <code class="docutils literal notranslate"><span class="pre">Numero</span></code> tendrá las siguientes propiedades: un <code class="docutils literal notranslate"><span class="pre">valor</span></code>, un par de valores <code class="docutils literal notranslate"><span class="pre">previos</span></code> para el caso de que el <code class="docutils literal notranslate"><span class="pre">valor</span></code> haya sido generado mediante una operación (por ejemplo, <span class="math notranslate nohighlight">\(2\)</span> y <span class="math notranslate nohighlight">\(2\)</span> en el caso de que multiplicados hayan generado el número <span class="math notranslate nohighlight">\(4\)</span>), la <code class="docutils literal notranslate"><span class="pre">operación</span></code> que generó dicho valor (en nuestro ejemplo, la multiplicación) y una etiqueta en caso de que queramos asociar nuestro <code class="docutils literal notranslate"><span class="pre">valor</span></code> a una variable. Por ahora, únicamente tendremos las operaciones de suma, multiplcación, resta y división:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Numero</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valor</span><span class="p">,</span> <span class="n">_previos</span><span class="o">=</span><span class="p">(),</span> <span class="n">_op</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">=</span> <span class="n">valor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_previos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">_previos</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_op</span> <span class="o">=</span> <span class="n">_op</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="n">etiqueta</span>

  <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> <span class="c1"># adición</span>
    <span class="n">otro</span> <span class="o">=</span> <span class="n">otro</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">otro</span><span class="p">,</span> <span class="n">Numero</span><span class="p">)</span> <span class="k">else</span> <span class="n">Numero</span><span class="p">(</span><span class="n">otro</span><span class="p">)</span> <span class="c1"># nos cercioramos de que el otro valor sea un Número</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">+</span> <span class="n">otro</span><span class="o">.</span><span class="n">valor</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">),</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> 
    <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">otro</span>

  <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> <span class="c1"># multiplicación</span>
    <span class="n">otro</span> <span class="o">=</span> <span class="n">otro</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">otro</span><span class="p">,</span> <span class="n">Numero</span><span class="p">)</span> <span class="k">else</span> <span class="n">Numero</span><span class="p">(</span><span class="n">otro</span><span class="p">)</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">*</span> <span class="n">otro</span><span class="o">.</span><span class="n">valor</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">),</span> <span class="s1">&#39;*&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">otro</span>

  <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> <span class="c1"># resta, substracción</span>
    <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">otro</span><span class="p">)</span>

  <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> <span class="c1"># división</span>
    <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">otro</span><span class="o">**-</span><span class="mi">1</span> <span class="c1">#dividir es lo mismo que multiplicar por el dividendo elevado a la menos 1</span>
  
  <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">otro</span> <span class="o">*</span> <span class="bp">self</span><span class="o">**-</span><span class="mi">1</span>

  <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># volver negativo un número</span>
    <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>

  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Valor=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span><span class="si">}</span><span class="s1">&#39;</span> <span class="c1"># esta función determina cómo se representa nuestro número</span>
</pre></div>
</div>
</div>
</div>
<p>Utilizaremos un problema más desafiante que una simple multiplicación:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definimos la función L con los siguientes números y operaciones:</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span> <span class="c1"># definimos c, que es el resultado de multiplicar a y b</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span> <span class="n">e</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span> <span class="n">L</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span> <span class="s1">&#39;L&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ejemplo: Valor de c: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1"> | Valores previos: </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">_previos</span><span class="si">}</span><span class="s1"> | Operación realizada para generar c: </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">_op</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ejemplo: Valor de c: Valor=-6.0 | Valores previos: {Valor=3.0, Valor=-2.0} | Operación realizada para generar c: *
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>El código para graficar no tiene que ver con las redes neuronales, de manera que queda fuera de nuestro enfoque explicarlo.</p>
</aside>
<p>También crearemos una función para graficar nuestras operaciones:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>

<span class="k">def</span> <span class="nf">rastreo</span><span class="p">(</span><span class="n">origen</span><span class="p">):</span>
  <span class="c1"># construye un conjunto de todos los nodos en un gráfico</span>
  <span class="n">nodos</span><span class="p">,</span> <span class="n">lineas</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">()</span>
  <span class="k">def</span> <span class="nf">construir</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodos</span><span class="p">:</span>
      <span class="n">nodos</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">parte</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">_previos</span><span class="p">:</span>
        <span class="n">lineas</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">parte</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">construir</span><span class="p">(</span><span class="n">parte</span><span class="p">)</span>
  <span class="n">construir</span><span class="p">(</span><span class="n">origen</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">nodos</span><span class="p">,</span> <span class="n">lineas</span>

<span class="k">def</span> <span class="nf">graficar</span><span class="p">(</span><span class="n">origen</span><span class="p">):</span>
  <span class="n">grafica</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;svg&#39;</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;rankdir&#39;</span><span class="p">:</span> <span class="s1">&#39;LR&#39;</span><span class="p">})</span> <span class="c1"># left to right, izquierda a derecha</span>

  <span class="n">nodos</span><span class="p">,</span> <span class="n">lineas</span> <span class="o">=</span> <span class="n">rastreo</span><span class="p">(</span><span class="n">origen</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodos</span><span class="p">:</span>
    <span class="n">uid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="c1"># por cada valor en la gráfica, crea un nodo rectangular (&#39;record&#39;) para él</span>
    <span class="n">grafica</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">uid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;{ </span><span class="si">%s</span><span class="s1"> | valor </span><span class="si">%.4f</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">etiqueta</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">valor</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;record&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">_op</span><span class="p">:</span>
      <span class="c1"># si el valor es resultado de una operación, crea un nodo para la operación</span>
      <span class="n">grafica</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">uid</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">_op</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">_op</span><span class="p">)</span>
      <span class="c1"># conecta los nodos</span>
      <span class="n">grafica</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">uid</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">_op</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="ow">in</span> <span class="n">lineas</span><span class="p">:</span>
    <span class="c1"># conecta n1 al nodo operación de n2</span>
    <span class="n">grafica</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">n1</span><span class="p">)),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span> <span class="o">+</span> <span class="n">n2</span><span class="o">.</span><span class="n">_op</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">grafica</span>
</pre></div>
</div>
</div>
</div>
<p>Finalmente, visualizamos la función<a class="footnote-reference brackets" href="#id6" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. El problema a resolver consiste en influir en los valores de la función <span class="math notranslate nohighlight">\(L\)</span> para llevarla a <span class="math notranslate nohighlight">\(0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">graficar</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ffb0554f4cdbb82d6eec858d6db576dbe80c979f9b42e1ebd103a57ea46cac67.svg" src="../../_images/ffb0554f4cdbb82d6eec858d6db576dbe80c979f9b42e1ebd103a57ea46cac67.svg" /></div>
</div>
<p>Como decíamos, intuitivamente creemos que la derivada puede ayudarnos: con la derivada sabemos qué impacto tiene cada variable en el resultado final <span class="math notranslate nohighlight">\(L\)</span>. En ese sentido, lo que tendremos que hacer primero es calcular la derivada de <span class="math notranslate nohighlight">\(L\)</span> con respecto a cada variable<a class="footnote-reference brackets" href="#id7" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<p>En principio, la derivada de <span class="math notranslate nohighlight">\(L\)</span> con respecto a sí misma es <span class="math notranslate nohighlight">\(1\)</span>: aunque suene absurdo y evidente a la vez, el cambio en <span class="math notranslate nohighlight">\(L\)</span> es proporcional (idéntico) a sí mismo. Ahora, la derivada de <span class="math notranslate nohighlight">\(L\)</span> con respecto a <span class="math notranslate nohighlight">\(f\)</span> y <span class="math notranslate nohighlight">\(e\)</span> la podemos averiguar con la fórmula que veníamos utilizando:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">derivada</span><span class="p">():</span>
  <span class="n">h</span> <span class="o">=</span> <span class="mf">0.000001</span>

  <span class="c1"># Función original</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
  <span class="n">d</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
  <span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span> <span class="n">e</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
  <span class="n">L1</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span> <span class="n">L</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span> <span class="s1">&#39;L1&#39;</span>

  <span class="c1"># Función con incremento h</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
  <span class="n">d</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
  <span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span> <span class="n">e</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
  <span class="n">e</span><span class="o">.</span><span class="n">valor</span> <span class="o">+=</span> <span class="n">h</span> <span class="c1"># aumento de h para obtener la derivada de L con respecto a e</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
  <span class="n">L2</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span> <span class="n">L</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span> <span class="s1">&#39;L2&#39;</span>

  <span class="nb">print</span><span class="p">((</span><span class="n">L2</span> <span class="o">-</span> <span class="n">L1</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span> <span class="c1"># fórmula de la derivada</span>

<span class="n">derivada</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valor=-2.9999999995311555
</pre></div>
</div>
</div>
</div>
<p>La derivada de la función <span class="math notranslate nohighlight">\(L\)</span> con respecto a <span class="math notranslate nohighlight">\(e\)</span> es aproximadamente <span class="math notranslate nohighlight">\(-3\)</span>. A estas alturas, ya habremos notado un patrón: cuando derivamos una multiplicación, la derivada parcial con respecto al multiplicando es el multiplicador. En este caso, <span class="math notranslate nohighlight">\(L\)</span> es el resultado de multiplicar <span class="math notranslate nohighlight">\(e\)</span> con <span class="math notranslate nohighlight">\(f\)</span>. Vimos que la derivada con respecto a <span class="math notranslate nohighlight">\(e\)</span> es <span class="math notranslate nohighlight">\(-3\)</span>, o sea <span class="math notranslate nohighlight">\(f\)</span>. Podemos inducir, empíricamente y por simetría, que la derivada con respecto a <span class="math notranslate nohighlight">\(f\)</span> es <span class="math notranslate nohighlight">\(e\)</span>, o sea 4.</p>
<p>Quizá también sea una buena oportunidad para demostrar analíticamente lo que venimos diciendo. Utilizando nuestra fórmula matemática, tenemos que:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial L(e, f)}{\partial e}=\lim _{h \rightarrow 0}{\frac{L(e + h, f)-L(e, f)}{h}} = {\frac{(e + h) \cdot f - e \cdot f}{h}} = {\frac{ef + hf - ef}{h}} = {\frac{hf}{h}} = f
\]</div>
<p>Y aunque la notación aparente complejidad, en realidad solo estamos sumando, multiplicando, restando y dividiendo.</p>
<p>Ahora que ya tenemos esta información, queremos continuar al nodo anterior: las derivadas con respecto a <span class="math notranslate nohighlight">\(c\)</span> y <span class="math notranslate nohighlight">\(d\)</span>. Pero aquí hay una sutileza que, bien entendida, nos dará la clave de las redes neuronales: debemos obtener la derivada de <span class="math notranslate nohighlight">\(L\)</span> con respecto a <span class="math notranslate nohighlight">\(c\)</span> y <span class="math notranslate nohighlight">\(d\)</span>, no la derivada de <span class="math notranslate nohighlight">\(e\)</span> con respecto a ellas. Entonces, ¿cómo podemos averiguar el impacto que <span class="math notranslate nohighlight">\(c\)</span> y <span class="math notranslate nohighlight">\(d\)</span> tienen en <span class="math notranslate nohighlight">\(L\)</span> a través de <span class="math notranslate nohighlight">\(e\)</span>? Para hacer este cálculo solo hace falta una intuición bastante simple.</p>
</section>
<section id="la-regla-de-la-cadena-propagacion-hacia-atras">
<h2>La regla de la cadena: propagación hacia atrás<a class="headerlink" href="#la-regla-de-la-cadena-propagacion-hacia-atras" title="Permalink to this heading">#</a></h2>
<p>Tomemos prestada la analogía de George Simmons: si una bicicleta es dos veces más rápida que una persona corriendo, y un automóvil cuatro veces más rápido que una bicicleta, entonces el automóvil es <span class="math notranslate nohighlight">\(2 \times 4 = 8\)</span> veces más rápido que una persona corriendo.</p>
<p>De igual forma, si queremos saber la influencia que <span class="math notranslate nohighlight">\(c\)</span> tiene en <span class="math notranslate nohighlight">\(L\)</span>, solo debemos obtener la derivada de <span class="math notranslate nohighlight">\(e\)</span> con respecto a <span class="math notranslate nohighlight">\(c\)</span>, y multiplicarla por la derivada de <span class="math notranslate nohighlight">\(L\)</span> con respecto a <span class="math notranslate nohighlight">\(e\)</span>. Es decir, debemos multiplicar la fuerza de <span class="math notranslate nohighlight">\(c\)</span> en <span class="math notranslate nohighlight">\(e\)</span> y la de <span class="math notranslate nohighlight">\(e\)</span> en <span class="math notranslate nohighlight">\(L\)</span> para saber con cuánta fuerza influye <span class="math notranslate nohighlight">\(c\)</span> en <span class="math notranslate nohighlight">\(L\)</span>. Lo mismo vale para <span class="math notranslate nohighlight">\(d\)</span> y todas las demás; a esta regla se le llama «regla de la cadena» (y mediante ella se realiza la «propagación hacia atrás» en el campo de la inteligencia artificial).</p>
<p>Ahora, para obtener la derivada de <span class="math notranslate nohighlight">\(e\)</span> con respecto a <span class="math notranslate nohighlight">\(c\)</span>, recordemos otro patrón que vimos: en una suma, la derivada nos daba como resultado <span class="math notranslate nohighlight">\(1\)</span> porque la función avanzaba en la misma proporción que avanzaba la variable. Verifiquémoslo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">deriv_e</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">(((</span><span class="n">c</span><span class="o">+</span><span class="mf">0.00001</span><span class="p">)</span><span class="o">+</span><span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">))</span> <span class="o">/</span> <span class="mf">0.00001</span>

<span class="n">deriv_e</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9999999999621422
</pre></div>
</div>
</div>
</div>
<p>En efecto, el resultado es aproximadamente <span class="math notranslate nohighlight">\(1\)</span>. Por simetría nuevamente, entendemos que la derivada de <span class="math notranslate nohighlight">\(e\)</span> con respecto a <span class="math notranslate nohighlight">\(d\)</span> también es <span class="math notranslate nohighlight">\(1\)</span>. Y para el lector exigente, analíticamente:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial e(c, d)}{\partial d}=\lim _{h \rightarrow 0}{\frac{e(c, d+h)-e(c, d)}{h}} = {\frac{(c + d + h) - (c + d)}{h}} = {\frac{(c+d) + h - (c+d)}{h}} = {\frac{h}{h}} = 1
\]</div>
<p>Y ahora que ya tenemos ambas derivadas parciales, podemos multiplicarlas siguiendo la regla de la cadena: <span class="math notranslate nohighlight">\(1 \times -3 = -3\)</span>. Así pues, la derivada de <span class="math notranslate nohighlight">\(L\)</span> con respecto a <span class="math notranslate nohighlight">\(c\)</span> y <span class="math notranslate nohighlight">\(d\)</span> es <span class="math notranslate nohighlight">\(-3\)</span>. En términos matemáticos, hemos hecho algo equivalente a:</p>
<div class="math notranslate nohighlight">
\[
\frac{dz}{dx} = \frac{dz}{dy} \cdot \frac{dy}{dx}
\]</div>
<p>Donde <span class="math notranslate nohighlight">\(z\)</span> depende de <span class="math notranslate nohighlight">\(y\)</span> y, a su vez, <span class="math notranslate nohighlight">\(y\)</span> depende de <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Comprobémoslo programáticamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">derivada</span><span class="p">():</span>
  <span class="n">h</span> <span class="o">=</span> <span class="mf">0.000001</span>

  <span class="c1"># Función original</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
  <span class="n">d</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
  <span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span> <span class="n">e</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
  <span class="n">L1</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span> <span class="n">L</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span> <span class="s1">&#39;L1&#39;</span>

  <span class="c1"># Función con incremento h</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
  <span class="n">c</span><span class="o">.</span><span class="n">valor</span> <span class="o">+=</span> <span class="n">h</span> <span class="c1"># aumento de h para obtener la derivada de L con respecto a c</span>
  <span class="n">d</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
  <span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span> <span class="n">e</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
  <span class="n">L2</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span> <span class="n">L</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span> <span class="s1">&#39;L2&#39;</span>

  <span class="nb">print</span><span class="p">((</span><span class="n">L2</span> <span class="o">-</span> <span class="n">L1</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span> <span class="c1"># fórmula de la derivada</span>

<span class="n">derivada</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valor=-2.9999999995311555
</pre></div>
</div>
</div>
</div>
<p>Finalmente, debemos hacer lo mismo para obtener las derivadas con respecto a <span class="math notranslate nohighlight">\(a\)</span> y <span class="math notranslate nohighlight">\(b\)</span>. Entonces, dado el patrón que habíamos descubierto, la derivada de <span class="math notranslate nohighlight">\(c\)</span> con respecto a <span class="math notranslate nohighlight">\(a\)</span> es <span class="math notranslate nohighlight">\(b\)</span>, o sea <span class="math notranslate nohighlight">\(3\)</span>, y viceversa: la derivada con respecto a <span class="math notranslate nohighlight">\(b\)</span> es <span class="math notranslate nohighlight">\(a\)</span>, o sea <span class="math notranslate nohighlight">\(-2\)</span>. Pero recordemos: estas derivadas «locales» son de la función <span class="math notranslate nohighlight">\(c\)</span>, y a nosotros nos interesa la derivada de <span class="math notranslate nohighlight">\(L\)</span>, es decir, la magnitud de la influencia que <span class="math notranslate nohighlight">\(a\)</span> y <span class="math notranslate nohighlight">\(b\)</span> tienen en <span class="math notranslate nohighlight">\(L\)</span>. Para saberlo, nuevamente debemos aplicar la regla de la cadena y multiplicar las derivadas que tenemos por la derivada de <span class="math notranslate nohighlight">\(L\)</span> con respecto a <span class="math notranslate nohighlight">\(c\)</span>. Entonces, la derivada parcial de <span class="math notranslate nohighlight">\(L\)</span> con respecto a <span class="math notranslate nohighlight">\(a\)</span> es <span class="math notranslate nohighlight">\(3 \times -3 = -9\)</span>, mientras que la derivada parcial con respecto a <span class="math notranslate nohighlight">\(b\)</span> es <span class="math notranslate nohighlight">\(-2 \times -3 = 6\)</span>.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>A la derivada global, es decir, a la que se da con respecto al resultado final y no al local, se le denomina «gradiente». Las fórmulas que utilizamos para derivar pueden leerse <a class="reference external" href="https://es.wikipedia.org/wiki/Derivada#C%C3%A1lculo_de_la_derivada">aquí</a>; algunas fórmulas que utilizaremos a continuación, <a class="reference external" href="https://aew61.github.io/blog/artificial_neural_networks/1_background/1.b_activation_functions_and_derivatives.html">aquí</a>.</p>
</aside>
<p>Ahora que ya tenemos estos valores, podemos optimizar nuestro código para contemplarlos y visualizarlos de mejor manera. Añadiremos también algunas funciones que después detallaremos. En la práctica, nadie calcula las derivadas manualmente como lo hicimos, puesto que sería una labor eterna; pero ya hemos aprendido los patrones para calcularlas, así que podemos implementarlos en nuestro código para que se calculen automáticamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">class</span> <span class="nc">Numero</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valor</span><span class="p">,</span> <span class="n">_previos</span><span class="o">=</span><span class="p">(),</span> <span class="n">_op</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">=</span> <span class="n">valor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># gradiente, comienza en 0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_propagar</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="kc">None</span> <span class="c1"># el valor predeterminado de la propagación hacia atrás es nulo</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_previos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">_previos</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_op</span> <span class="o">=</span> <span class="n">_op</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="n">etiqueta</span>

  <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> 
    <span class="n">otro</span> <span class="o">=</span> <span class="n">otro</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">otro</span><span class="p">,</span> <span class="n">Numero</span><span class="p">)</span> <span class="k">else</span> <span class="n">Numero</span><span class="p">(</span><span class="n">otro</span><span class="p">)</span> 
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">+</span> <span class="n">otro</span><span class="o">.</span><span class="n">valor</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">),</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_propagar</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span> <span class="c1"># la derivada de una suma es 1; después, se multiplica por la «derivada global»</span>
      <span class="n">otro</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span>
    <span class="n">resultado</span><span class="o">.</span><span class="n">_propagar</span> <span class="o">=</span> <span class="n">_propagar</span>

    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> 
    <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">otro</span>

  <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span>
    <span class="n">otro</span> <span class="o">=</span> <span class="n">otro</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">otro</span><span class="p">,</span> <span class="n">Numero</span><span class="p">)</span> <span class="k">else</span> <span class="n">Numero</span><span class="p">(</span><span class="n">otro</span><span class="p">)</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">*</span> <span class="n">otro</span><span class="o">.</span><span class="n">valor</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">),</span> <span class="s1">&#39;*&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_propagar</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="n">otro</span><span class="o">.</span><span class="n">valor</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span> <span class="c1"># la derivada de la multiplicación es igual al multiplicando por la derivada global</span>
      <span class="n">otro</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span>
    <span class="n">resultado</span><span class="o">.</span><span class="n">_propagar</span> <span class="o">=</span> <span class="n">_propagar</span>

    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">otro</span>

  <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> <span class="c1"># potenciación</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">otro</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span><span class="o">**</span><span class="n">otro</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,),</span> <span class="sa">f</span><span class="s1">&#39;**</span><span class="si">{</span><span class="n">otro</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_propagar</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="n">otro</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">**</span> <span class="p">(</span><span class="n">otro</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span> <span class="c1"># recordemos la fórmula: yx**y-1</span>
    <span class="n">resultado</span><span class="o">.</span><span class="n">_propagar</span> <span class="o">=</span> <span class="n">_propagar</span>

    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> 
    <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">otro</span><span class="p">)</span>

  <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">otro</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="p">)</span>

  <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
    <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>

  <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span> 
    <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">otro</span><span class="o">**-</span><span class="mi">1</span> 
  
  <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otro</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">otro</span> <span class="o">*</span> <span class="bp">self</span><span class="o">**-</span><span class="mi">1</span>

  <span class="k">def</span> <span class="nf">ReLU</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">((</span><span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">valor</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="p">,),</span> <span class="s1">&#39;ReLU&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_propagar</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">resultado</span><span class="o">.</span><span class="n">valor</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span> <span class="c1"># la derivada es 1 si x &gt; 0, 0 si x &lt; 0</span>
    <span class="n">resultado</span><span class="o">.</span><span class="n">_propagar</span> <span class="o">=</span> <span class="n">_propagar</span>
    
    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="nf">tanh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># tangente hiperbólica</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,),</span> <span class="s1">&#39;tanh&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_propagar</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span> <span class="c1"># según la fórmula 1-tanh**2x</span>
    <span class="n">resultado</span><span class="o">.</span><span class="n">_propagar</span> <span class="o">=</span> <span class="n">_propagar</span>

    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="nf">sigmoide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span><span class="p">))</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,),</span> <span class="s1">&#39;sigmoide&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_propagar</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">))</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span> <span class="c1"># la derviada es s(x)(1-s(x))</span>
    <span class="n">resultado</span><span class="o">.</span><span class="n">_propagar</span> <span class="o">=</span> <span class="n">_propagar</span>

    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># exponenciación</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="p">,),</span> <span class="s1">&#39;exp&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_propagar</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span>
    <span class="n">resultado</span><span class="o">.</span><span class="n">_propagar</span> <span class="o">=</span> <span class="n">_propagar</span>

    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># logaritmo natural</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="p">,),</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_propagar</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span> <span class="o">*</span> <span class="n">resultado</span><span class="o">.</span><span class="n">grad</span>
    <span class="n">resultado</span><span class="o">.</span><span class="n">_propagar</span> <span class="o">=</span> <span class="n">_propagar</span>

    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="nf">propagar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># ordenamiento topológico</span>
    <span class="n">topo</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">visitados</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">construir_topo</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visitados</span><span class="p">:</span>
        <span class="n">visitados</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">previo</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">_previos</span><span class="p">:</span>
          <span class="n">construir_topo</span><span class="p">(</span><span class="n">previo</span><span class="p">)</span>
        <span class="n">topo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">construir_topo</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># asignamos la derivada del valor final con respecto a sí mismo: 1</span>
    <span class="k">for</span> <span class="n">nodo</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">topo</span><span class="p">):</span> <span class="c1"># comenzamos desde adelante hacia atrás</span>
      <span class="n">nodo</span><span class="o">.</span><span class="n">_propagar</span><span class="p">()</span>

  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Valor=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">valor</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>

<span class="k">def</span> <span class="nf">rastreo</span><span class="p">(</span><span class="n">origen</span><span class="p">):</span>
  <span class="n">nodos</span><span class="p">,</span> <span class="n">lineas</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">()</span>
  <span class="k">def</span> <span class="nf">construir</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodos</span><span class="p">:</span>
      <span class="n">nodos</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">parte</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">_previos</span><span class="p">:</span>
        <span class="n">lineas</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">parte</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
        <span class="n">construir</span><span class="p">(</span><span class="n">parte</span><span class="p">)</span>
  <span class="n">construir</span><span class="p">(</span><span class="n">origen</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">nodos</span><span class="p">,</span> <span class="n">lineas</span>

<span class="k">def</span> <span class="nf">graficar</span><span class="p">(</span><span class="n">origen</span><span class="p">):</span>
  <span class="n">grafica</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;svg&#39;</span><span class="p">,</span> <span class="n">graph_attr</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;rankdir&#39;</span><span class="p">:</span> <span class="s1">&#39;LR&#39;</span><span class="p">})</span>

  <span class="n">nodos</span><span class="p">,</span> <span class="n">lineas</span> <span class="o">=</span> <span class="n">rastreo</span><span class="p">(</span><span class="n">origen</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodos</span><span class="p">:</span>
    <span class="n">uid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">grafica</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">uid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;{ </span><span class="si">%s</span><span class="s1"> | valor </span><span class="si">%.4f</span><span class="s1"> | grad </span><span class="si">%.4f</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">etiqueta</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">valor</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">grad</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;record&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">_op</span><span class="p">:</span>
      <span class="n">grafica</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">uid</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">_op</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">_op</span><span class="p">)</span>
      <span class="n">grafica</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">uid</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">_op</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="ow">in</span> <span class="n">lineas</span><span class="p">:</span>
    <span class="n">grafica</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">n1</span><span class="p">)),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span> <span class="o">+</span> <span class="n">n2</span><span class="o">.</span><span class="n">_op</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">grafica</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span> <span class="n">e</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span> <span class="n">L</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span> <span class="s1">&#39;L&#39;</span>

<span class="n">graficar</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b7494524cd3f98bfe1df8b762be73bf71162fa09561d354292f3c869b3f3e762.svg" src="../../_images/b7494524cd3f98bfe1df8b762be73bf71162fa09561d354292f3c869b3f3e762.svg" /></div>
</div>
<p>Ahora obtendremos las derivadas, pero programática en vez de manualmente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">propagar</span><span class="p">()</span>
<span class="n">graficar</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5e5c7077e2c62a693ab0673a20e12c2f6f0bfb88ac1342d7f9f5ed866e230c18.svg" src="../../_images/5e5c7077e2c62a693ab0673a20e12c2f6f0bfb88ac1342d7f9f5ed866e230c18.svg" /></div>
</div>
<p>Bien. Ahora pongamos en práctica nuestra intuición: dado que el gradiente (o derivada global, o la colección de derivadas parciales de <span class="math notranslate nohighlight">\(L\)</span> con respecto a cada variable) nos dice la «fuerza» con la que cada número aumenta el resultado final de la función, podemos utilizar esa misma fuerza para alterar nuestros valores y, con ello, aumentar el valor de <span class="math notranslate nohighlight">\(L\)</span>. La bondad de utilizar el gradiente es que nos indica la «dirección» y la magnitud en la que debemos modificar cada valor para aumentar el resultado final, es decir: aumentar el valor de cada variable en la misma dirección del gradiente, contribuye a elevar el valor de la función global. Incluso si el gradiente tiene un valor negativo, eso indicaría que el valor de la variable debe disminuir para incrementar la función. De igual forma, si lo que queremos es disminuir el valor de una función, solo debemos ir en la dirección opuesta —<em>i. e.</em>, negativa— al gradiente.</p>
<p>Las siguientes imágenes ilustran con flechas azules la dirección del gradiente, y en blanco y negro a los valores de la función (el negro indica los valores más altos). Como digo, el gradiente indica la dirección en la que la función aumenta su valor:</p>
<img src='https://upload.wikimedia.org/wikipedia/commons/0/0f/Gradient2.svg' width=500>
<p>Solo hace falta un detalle: al emplear esta estrategia, debemos ser cuidadosos de no excedernos en el aumento del resultado, puesto que queremos llegar a <span class="math notranslate nohighlight">\(0\)</span> sin superarlo. Para ello, podemos atenuar la fuerza de los gradientes, multiplicándolos por un número pequeño como <span class="math notranslate nohighlight">\(0.01\)</span> o <span class="math notranslate nohighlight">\(0.1\)</span> para luego sumar (en caso de querer aumentar el resultado final de la función) o restar ese valor a la variable. Probemos un ejemplo con la variable <span class="math notranslate nohighlight">\(a\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">na</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">grad</span> <span class="c1"># nuevo valor de a: su derivada multiplicada por 0.1 + el valor anterior de a</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">na</span><span class="o">.</span><span class="n">valor</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="c1"># asignamos el nuevo valor a la variable</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span> <span class="n">e</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span> <span class="n">L</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span> <span class="s1">&#39;L&#39;</span>

<span class="n">L</span><span class="o">.</span><span class="n">propagar</span><span class="p">()</span>

<span class="n">graficar</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4109df9dc37a3ef874d2e9c525927d1351130bccbd856542311d3c8e6407a038.svg" src="../../_images/4109df9dc37a3ef874d2e9c525927d1351130bccbd856542311d3c8e6407a038.svg" /></div>
</div>
<p>Bien, parece que nuestro método funciona. Sin embargo, comprobamos que quizá nuestra fuerza es elevada, puesto que disminuyó mucho el resultado. Probablemente tengamos un mejor resultado si hacemos esto con todas nuestras variables, pero con una fuerza más atenuada (<span class="math notranslate nohighlight">\(0.01\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">na</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">grad</span>
<span class="n">nb</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">grad</span>
<span class="n">nd</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">d</span><span class="o">.</span><span class="n">grad</span>
<span class="n">nf</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">f</span><span class="o">.</span><span class="n">grad</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">na</span><span class="o">.</span><span class="n">valor</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">nb</span><span class="o">.</span><span class="n">valor</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">valor</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span> <span class="n">e</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">nf</span><span class="o">.</span><span class="n">valor</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">etiqueta</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">e</span><span class="p">;</span> <span class="n">L</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span> <span class="s1">&#39;L&#39;</span>

<span class="n">L</span><span class="o">.</span><span class="n">propagar</span><span class="p">()</span>

<span class="n">graficar</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/292aa95acad81ef9c0792575a873b6fe0ca47d36e906cebd1a2a9e364d371c6c.svg" src="../../_images/292aa95acad81ef9c0792575a873b6fe0ca47d36e906cebd1a2a9e364d371c6c.svg" /></div>
</div>
<p>Aunque no hayamos conseguido un resultado de exactamente 0, nos hemos aproximado significativamente con nuestro nuevo método programático. Pronto explotaremos el verdadero poder detrás de esta nueva herramienta nuestra, aunque desde ya podamos proclamar —con Françoise Hardy— ¡voilà! Esta es la esencia del aprendizaje en una red neuronal.</p>
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/4YIZP4nlw3jV5DkXGB56iG?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
<hr class="docutils" />
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p><em>Bottomless wonders spring from simple rules, which are repeated without end</em>.
Benoît Mandelbrot</p>
</aside>
</section>
<section id="perceptron-multicapa">
<h2>Perceptrón multicapa<a class="headerlink" href="#perceptron-multicapa" title="Permalink to this heading">#</a></h2>
<p>Anteriormente, construimos una especie de neurona; sin embargo, el poder de una red neuronal consiste en que tiene millones de neuronas, todas optimizando sus valores para darnos el resultado que deseamos (en nuestro ejemplo: <span class="math notranslate nohighlight">\(0\)</span>).</p>
<p>A continuación, construiremos una red neuronal llamada «perceptrón multicapa» (<em>Multilayer Perceptron</em> o MLP en inglés) que nos permitirá resolver problemas prácticos. Como ejemplo, la entrenaremos para que identifique sarcasmo en reseñas de películas.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>El ejemplo está inspirado en aquel formulado por <a class="reference external" href="https://qr.ae/pvKSx5">Sriraman Madhavan</a>.</p>
</aside>
<p>Para detectar sarcasmo en las reseñas que los usuarios dan sobre una película, podríamos tomar como base dos variables: el sentimiento (con valores del <span class="math notranslate nohighlight">\(1\)</span> al <span class="math notranslate nohighlight">\(5\)</span>, donde <span class="math notranslate nohighlight">\(5\)</span> es un sentimiento positivo y <span class="math notranslate nohighlight">\(1\)</span> uno negativo) y la calificación asignada (también con valores del <span class="math notranslate nohighlight">\(1\)</span> al <span class="math notranslate nohighlight">\(5\)</span>). El resultado tendría que ser <span class="math notranslate nohighlight">\(1\)</span> para sarcasmo y <span class="math notranslate nohighlight">\(0\)</span> para ausencia de sarcasmo. Por ejemplo:</p>
<ul class="simple">
<li><p><em>Genial, me encanta cuando veo una película de terror con la típica trama de siempre</em>. Calificación: <span class="math notranslate nohighlight">\(2/5\)</span>.</p></li>
</ul>
<p>En este caso, el sentimiento es positivo (utiliza expresiones como «genial», «me encanta»), pero la reseña es negativa, de manera que podemos establecer una relación de proporcionalidad inversa entre ambas variables para detectar el sarcasmo: si la calificación es baja pero el sentimiento «alto», entonces hay sarcasmo (es decir, sarcasmo <span class="math notranslate nohighlight">\(=1\)</span>).</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Para visualizar de mejor manera los siguientes gráficos, recomiendo dar clic derecho en el gráfico y abrirlo en una nueva pestaña.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#entradas</span>
<span class="n">sentimiento</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;sentimiento&#39;</span><span class="p">)</span>
<span class="n">calificacion</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;calificacion&#39;</span><span class="p">)</span>

<span class="c1"># pesos (weights)</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;w1&#39;</span><span class="p">)</span>
<span class="n">w2</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;w2&#39;</span><span class="p">)</span>

<span class="c1"># sesgo (bias)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="c1"># x1*w1 + x2*w2 + b</span>
<span class="n">x1w1</span> <span class="o">=</span> <span class="n">sentimiento</span><span class="o">*</span><span class="n">w1</span><span class="p">;</span> <span class="n">x1w1</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;x1w1&#39;</span>
<span class="n">x2w2</span> <span class="o">=</span> <span class="n">calificacion</span><span class="o">*</span><span class="n">w2</span><span class="p">;</span> <span class="n">x2w2</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;x2w2&#39;</span>
<span class="n">sumatoria</span> <span class="o">=</span> <span class="n">x1w1</span> <span class="o">+</span> <span class="n">x2w2</span><span class="p">;</span> <span class="n">sumatoria</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;s&#39;</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">sumatoria</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span> <span class="n">n</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;n&#39;</span>

<span class="c1"># activación</span>
<span class="n">sarcasmo</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">tanh</span><span class="p">();</span> <span class="n">sarcasmo</span><span class="o">.</span><span class="n">etiqueta</span><span class="o">=</span> <span class="s1">&#39;sarcasmo&#39;</span>

<span class="n">sarcasmo</span><span class="o">.</span><span class="n">propagar</span><span class="p">()</span>

<span class="n">graficar</span><span class="p">(</span><span class="n">sarcasmo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d28664f133e78cf9f5ac292e99d79ebe596b4a69e26ad471ea620ba0eee9d909.svg" src="../../_images/d28664f133e78cf9f5ac292e99d79ebe596b4a69e26ad471ea620ba0eee9d909.svg" /></div>
</div>
<p>Por el momento, nuestros valores son aleatorios y todo funciona mal. La calificación y el sentimiento que asignamos son <span class="math notranslate nohighlight">\(5\)</span>, pero la neurona indica que la reseña es sarcástica porque da <span class="math notranslate nohighlight">\(\approx1\)</span> como resultado. Al contrario, queremos que el sarcasmo sea <span class="math notranslate nohighlight">\(0\)</span> en este caso. Podemos optimizarla programáticamente ahora que ya conocemos la propagación hacia atrás.</p>
<p>Primero, crearemos la clase <code class="docutils literal notranslate"><span class="pre">Neurona</span></code> para crear una estructura como la anterior. Al pasar nuestras variables por la <code class="docutils literal notranslate"><span class="pre">Neurona</span></code>, obtendremos un <code class="docutils literal notranslate"><span class="pre">peso</span></code> y un <code class="docutils literal notranslate"><span class="pre">sesgo</span></code> por cada una. Hecho esto, realizaremos operaciones con el peso, el sesgo y las entradas para transformar las entradas y, con ello, obtengamos al final el resultado deseado. Por ejemplo: si mis entradas son <span class="math notranslate nohighlight">\(5\)</span> y <span class="math notranslate nohighlight">\(5\)</span> —como en nuestro ejemplo—, nosotros queremos encontrar unos pesos y sesgos tales que, multiplicados y sumados por <span class="math notranslate nohighlight">\(5\)</span> y <span class="math notranslate nohighlight">\(5\)</span>, nos den como resultado un <span class="math notranslate nohighlight">\(0\)</span>, puesto que <span class="math notranslate nohighlight">\(5\)</span> y <span class="math notranslate nohighlight">\(5\)</span> significa ausencia de sarcasmo en este caso. Al mismo tiempo, queremos que esos mismos pesos y sesgos, por ejemplo al ser multiplicados y sumados por un sentimiento de <span class="math notranslate nohighlight">\(5\)</span> y una calificación de <span class="math notranslate nohighlight">\(1\)</span>, nos arrojen <span class="math notranslate nohighlight">\(1\)</span> como resultado, puesto que eso indicaría sarcasmo.</p>
<p>Para obtener como resultado una probabilidad de sarcasmo del <span class="math notranslate nohighlight">\(0\)</span> al <span class="math notranslate nohighlight">\(1\)</span>, utilizaremos la función tangente hiperbólica, la cual es muy similar a las que vimos con anterioridad (sigmoide, ReLU, softmax): cuando nuestros valores la atraviesen, ella nos dará como resultado un valor del <span class="math notranslate nohighlight">\(-1\)</span> al <span class="math notranslate nohighlight">\(1\)</span><a class="footnote-reference brackets" href="#id8" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="k">class</span> <span class="nc">Neurona</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nentradas</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peso</span> <span class="o">=</span> <span class="p">[</span><span class="n">Numero</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nentradas</span><span class="p">)]</span> <span class="c1"># cada entrada tendrá un peso, que será un número aleatorio</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sesgo</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># un sesgo con valor aleatorio del -1 al 1</span>

  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># peso * x + sesgo</span>
    <span class="n">activacion</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">peso_i</span><span class="o">*</span><span class="n">x_i</span> <span class="k">for</span> <span class="n">peso_i</span><span class="p">,</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peso</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sesgo</span><span class="p">)</span> <span class="c1">#multiplicamos, sumamos</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">activacion</span><span class="o">.</span><span class="n">tanh</span><span class="p">()</span> <span class="c1"># aplicamos la función tangente hiperbólica</span>
    <span class="k">return</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="nf">parametros</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">peso</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sesgo</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#entradas</span>
<span class="n">sentimiento</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;sentimiento&#39;</span><span class="p">)</span>
<span class="n">calificacion</span> <span class="o">=</span> <span class="n">Numero</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">etiqueta</span><span class="o">=</span><span class="s1">&#39;calificacion&#39;</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">Neurona</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># creamos una neurona</span>

<span class="n">neuron</span> <span class="o">=</span> <span class="n">N</span><span class="p">([</span><span class="n">sentimiento</span><span class="p">,</span> <span class="n">calificacion</span><span class="p">])</span> <span class="c1"># damos a las variables como valores de entrada</span>

<span class="n">neuron</span><span class="o">.</span><span class="n">propagar</span><span class="p">()</span>

<span class="n">graficar</span><span class="p">(</span><span class="n">neuron</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/98b71e1ccb2b4a31e95c4f377bc09c7dbd2bdf163d862d00e644b8e2445cbc17.svg" src="../../_images/98b71e1ccb2b4a31e95c4f377bc09c7dbd2bdf163d862d00e644b8e2445cbc17.svg" /></div>
</div>
<p>Nuestros pesos y sesgos tienen valores aleatorios, de manera que esto sigue sin funcionar. Para optimizarlos apropiadamente, será mejor crear una arquitectura más robusta. Entendámonos: será difícil que encontremos un par de pesos tales que, multiplicados por nuestras dos entradas, reflejen apropiadamente el sarcasmo como queremos. Si tenemos más pesos, probablemente sea más fácil encontrar una combinación de números que arroje los resultados que queremos.</p>
<p>Para ello, crearemos una red neuronal. Lo único que nos falta es una forma de conectar varias neuronas entre sí, así podremos tener más pesos y sesgos que entrenar, lo cual se traduce en mejor desempeño.</p>
<p>Construiremos, pues, una «capa», que no es más que una forma programática de definir cuántas neuronas queremos para nuestras entradas, es decir, de generar una serie de neuronas; y finalmente conectaremos todo con un «perceptrón multicapa», que consiste en unir varias capas entre sí:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Capa</span><span class="p">:</span> <span class="c1"># Layer</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nentradas</span><span class="p">,</span> <span class="n">nsalidas</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">neuronas</span> <span class="o">=</span> <span class="p">[</span><span class="n">Neurona</span><span class="p">(</span><span class="n">nentradas</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsalidas</span><span class="p">)]</span>

  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neuronas</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">resultado</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultado</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">resultado</span>

  <span class="k">def</span> <span class="nf">parametros</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">parametro</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neuronas</span> <span class="k">for</span> <span class="n">parametro</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">parametros</span><span class="p">()]</span>

<span class="k">class</span> <span class="nc">MLP</span><span class="p">:</span> <span class="c1"># Perceptrón multicapa</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nentrada</span><span class="p">,</span> <span class="n">nsalidas</span><span class="p">):</span>
    <span class="n">tamaño</span> <span class="o">=</span> <span class="p">[</span><span class="n">nentrada</span><span class="p">]</span> <span class="o">+</span> <span class="n">nsalidas</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">capas</span> <span class="o">=</span> <span class="p">[</span><span class="n">Capa</span><span class="p">(</span><span class="n">tamaño</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tamaño</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nsalidas</span><span class="p">))]</span>

  <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">capa</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">capas</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="n">capa</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>

  <span class="k">def</span> <span class="nf">parametros</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">parametro</span> <span class="k">for</span> <span class="n">capa</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">capas</span> <span class="k">for</span> <span class="n">parametro</span> <span class="ow">in</span> <span class="n">capa</span><span class="o">.</span><span class="n">parametros</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<p>Veamos una capa como ejemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Capa</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">graficar</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7a37908d780ca547927215c442f15836ecfa58c4dddcdf13ec1ab7f991544f27.svg" src="../../_images/7a37908d780ca547927215c442f15836ecfa58c4dddcdf13ec1ab7f991544f27.svg" /></div>
</div>
<p>Ahora veamos una red neuronal de la especie perceptrón multicapa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">RN</span> <span class="o">=</span> <span class="n">MLP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">graficar</span><span class="p">(</span><span class="n">RN</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4d7d0ac151612c02c57e37c6b191fa14dd832d6d8fe6bf2ae12728e5879c559d.svg" src="../../_images/4d7d0ac151612c02c57e37c6b191fa14dd832d6d8fe6bf2ae12728e5879c559d.svg" /></div>
</div>
<p>Como vemos, únicamente estamos interconectando y creando más neuronas para que nuestro modelo tenga más potencia. Al mismo tiempo, vemos que una neurona interconecta las entradas entre sí a través de pesos y sesgos. Los pesos y sesgos, además de realizar operaciones diferenciables (es decir, que podemos derivar), nos ayudarán a ir midiendo la relevancia de cada entrada para, con base en el gradiente, ajustarse en proporción a dicha relevancia. De igual forma, los pesos y sesgos articularán el patrón de números que en este caso necesitamos para convertir cada combinación de entradas en una probabilidad de sarcasmo.</p>
<p>Ahora manos a la obra. Daremos a nuestro modelo cuatro entradas de entrenamiento (es decir, serán ejemplos para que la red neuronal aprenda): cada entrada tendrá el sentimiento y la calificación asignada, así como el valor de sarcasmo objetivo que deseamos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">entradas</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="c1"># no sarcasmo</span>
    <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,],</span> <span class="c1"># sarcasmo</span>
    <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="c1"># sarcasmo</span>
    <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="c1"># no sarcasmo</span>
<span class="p">]</span>

<span class="n">objetivos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">predicciones</span> <span class="o">=</span> <span class="p">[</span><span class="n">RN</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">entradas</span><span class="p">]</span>
<span class="n">predicciones</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Valor=0.3669362864564352,
 Valor=0.06860246608538911,
 Valor=0.3213103120229461,
 Valor=0.3486194765977301]
</pre></div>
</div>
</div>
</div>
<p>Nuestras predicciones de sarcasmo fueron generadas con valores aleatorios, de manera que todas son erróneas. Ahora, debemos cuantificar qué tan alejadas están de su objetivo. Para ello, crearemos una función que mida la diferencia entre el objetivo y la predicción. Se trata de una simple resta, pero la elevaremos al cuadrado para obtener solo números positivos:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>A esta función se le llama «error cuadrático medio» (o <em>mean squared error</em>, MSE en inglés); matemáticamente podemos definirla como <span class="math notranslate nohighlight">\(\frac{1}{n} \sum_{i=1}^n (y_i - \hat{y}_i)^2\)</span>, aunque nosotros no hemos utilizado el promedio de la pérdida (o sea, <span class="math notranslate nohighlight">\(\frac{1}{n}\)</span>) por conveniencia para nuestro problema. Esta expresión matemática es la «función de pérdida» (<em>loss function</em>) más simple que hay, pues solo estamos haciendo una sumatoria con la resta entre objetivos y predicciones. Digamos que esta operación mide la distancia entre el objetivo y la predicción.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fn_perdida</span> <span class="o">=</span> <span class="p">[(</span><span class="n">pred</span> <span class="o">-</span> <span class="n">obj</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">pred</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predicciones</span><span class="p">,</span> <span class="n">objetivos</span><span class="p">)]</span> <span class="c1">#Mean Squared Error</span>
<span class="n">fn_perdida</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Valor=0.13464223831843908,
 Valor=0.8675013661822187,
 Valor=0.46061969256639074,
 Valor=0.1215355394632753]
</pre></div>
</div>
</div>
</div>
<p>Ahora, sumaremos los valores entre sí para obtener una sola cifra que nos permita cuantificar el desempeño general de nuestro modelo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">perdida</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">fn_perdida</span><span class="p">)</span>
<span class="n">perdida</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valor=1.5842988365303239
</pre></div>
</div>
</div>
</div>
<p>Luego, con base en la función de pérdida, haremos propagación hacia atrás: obtendremos los gradientes y, con ello, sabremos en qué dirección modificar nuestros pesos y sesgos para que la pérdida (o el error, o la distancia) sea <span class="math notranslate nohighlight">\(0\)</span>, es decir, que nuestras predicciones sean idénticas a nuestros objetivos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">perdida</span><span class="o">.</span><span class="n">propagar</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">graficar</span><span class="p">(</span><span class="n">perdida</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f27eabbc4321f0980a05e2d61a50c5907741f075aa57e66d9b422d535777a25e.svg" src="../../_images/f27eabbc4321f0980a05e2d61a50c5907741f075aa57e66d9b422d535777a25e.svg" /></div>
</div>
<p>Esto ya luce mucho más como una red neuronal. Calcular manualmente todos los gradientes sería engorroso; pero la programación nos permite apalancarnos de los algoritmos, las matemáticas y las computadoras para explotar su potencial a gran escala.</p>
<p>Echemos un vistazo a nuestros parámetros (o sea, pesos y sesgos):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">RN</span><span class="o">.</span><span class="n">parametros</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Valor=0.26185647542075774,
 Valor=-0.3897146431515013,
 Valor=-0.042130217416122884,
 Valor=0.716233520043825,
 Valor=0.34035823314645985,
 Valor=-0.38262186196333725,
 Valor=0.016423299964780647,
 Valor=-0.9183633316805504,
 Valor=-0.5763110561373717,
 Valor=0.019367922187966347,
 Valor=0.12454783116525658,
 Valor=0.6707556894941378,
 Valor=0.834698024121612,
 Valor=0.254042516410647,
 Valor=-0.6730022053225764,
 Valor=-0.8928621154187195,
 Valor=0.7161297325281775,
 Valor=0.09323426117937772,
 Valor=0.7985780052593621,
 Valor=-0.9972537117506883,
 Valor=-0.0037082550344191834,
 Valor=0.7422268948402582,
 Valor=-0.7202178129671104,
 Valor=-0.49309665896689103,
 Valor=0.48794442651441616,
 Valor=0.6622683039011021,
 Valor=-0.9732767794233275,
 Valor=0.7338007914809526,
 Valor=-0.12433377269499779,
 Valor=0.6796016177396522,
 Valor=-0.2252461785794555,
 Valor=-0.25469641100646667,
 Valor=0.25222074387643856,
 Valor=-0.636707051411459,
 Valor=-0.08679161950639269,
 Valor=0.26446327705831196,
 Valor=0.21401883070848138,
 Valor=0.3809439666539909,
 Valor=-0.010349121884670964,
 Valor=-0.47937169114088274,
 Valor=-0.7563496531288552,
 Valor=-0.690391901144549,
 Valor=0.9515007803442808,
 Valor=0.6590463877459278,
 Valor=0.21212402329507696]
</pre></div>
</div>
</div>
</div>
<p>Aunque para nosotros puedan no significar nada, lo cierto es que con base en el gradiente, nuestro modelo aprenderá a configurarlos de tal manera que representen un patrón cuya función será arrojar el resultado que nosotros queremos.</p>
<p>Ahora, dado que nuestra función de pérdida es positiva, queremos disminuirla. Si los gradientes nos indican la dirección en la que podemos aumentar el resultado de una función, entonces en este caso queremos ir en dirección opuesta al gradiente, pues eso tendría como resultado una disminución del resultado de la función. Para ello, sumaremos valor a las variables en el sentido <strong>inverso</strong> al gradiente (o, visto de otra forma, les restaremos valor según nos indique el gradiente).</p>
<p>Para optimizar de mejor manera, haremos este mismo paso <span class="math notranslate nohighlight">\(30\)</span> veces, puesto que los cambios serán diminutos:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Al proceso de «propagar hacia atrás» las derivadas parciales de cada neurona se le denomina «descenso de gradiente estocástico» (<em>stochastic gradient descent</em>) porque, como decíamos, disminuimos la función de pérdida con base en el gradiente. «Estocástico» significa «aleatorio» y utilizamos este término porque en un inicio nuestros parámetros <span class="math notranslate nohighlight">\(w, b\)</span> eran aleatorios. En suma, utilizamos parámetros —sesgos, pesos— aleatorios para optimizar nuestra red neuronal, disminuyendo la pérdida a través de ellos con base en el gradiente.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>

  <span class="c1"># paso hacia delante</span>
  <span class="n">preds</span> <span class="o">=</span> <span class="p">[</span><span class="n">RN</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">entradas</span><span class="p">]</span>
  <span class="n">perdida</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">pred</span> <span class="o">-</span> <span class="n">obj</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">pred</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">objetivos</span><span class="p">)])</span>

  <span class="c1"># propagación hacia atrás, Stochastic Gradient Descent</span>
  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">RN</span><span class="o">.</span><span class="n">parametros</span><span class="p">():</span>
    <span class="n">p</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="mf">0.0</span>
  <span class="n">perdida</span><span class="o">.</span><span class="n">propagar</span><span class="p">()</span>

  <span class="c1"># actualizar</span>
  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">RN</span><span class="o">.</span><span class="n">parametros</span><span class="p">():</span>
    <span class="n">p</span><span class="o">.</span><span class="n">valor</span> <span class="o">+=</span> <span class="o">-</span><span class="mf">0.07</span> <span class="o">*</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span>

  <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">perdida</span><span class="o">.</span><span class="n">valor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 1.5842988365303239
1 1.2529558664951095
2 0.587216087017959
3 0.4191023147078547
4 0.5752410954325351
5 1.1191852453113773
6 1.784366523080085
7 1.652128457073363
8 1.224657076741451
9 0.26771058028648226
10 0.41855267707767796
11 0.707877061951523
12 0.15361704203665727
13 0.12954214337233716
14 0.12316318950192393
15 0.12964905806896287
16 0.1261090038316882
17 0.1336944727568814
18 0.11078544833502019
19 0.102441253791397
20 0.08312278356688153
21 0.0723339169867922
22 0.06107490601393822
23 0.053290880990198526
24 0.04659821460517871
25 0.04138965501323435
26 0.03716069258091919
27 0.03363478739730862
28 0.030798690241934046
29 0.02833061619126015
</pre></div>
</div>
</div>
</div>
<p>Al parecer, nuestra función de pérdida disminuyó casi a cero. Comprobemos que nuestras predicciones ahora sean más similares a nuestros objetivos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">preds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Valor=0.1016585786227638,
 Valor=0.9171470012496584,
 Valor=0.8984522443847082,
 Valor=0.02862836899357634]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">objetivos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, 1.0, 1.0, 0.0]
</pre></div>
</div>
</div>
</div>
<p>En efecto, nuestro modelo ya es mucho más apto ahora que antes para detectar sarcasmo. ¿Qué tal si hacemos un test con una nueva calificación? El sentimiento será de <span class="math notranslate nohighlight">\(5\)</span> y la calificación <span class="math notranslate nohighlight">\(1.5\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>

<span class="n">prediccion</span> <span class="o">=</span> <span class="n">RN</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">prediccion</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valor=0.9022088768249822
</pre></div>
</div>
</div>
</div>
<p>Nuestra red neuronal considera que existe un <span class="math notranslate nohighlight">\(\approx90 \%\)</span> de probabilidad de que sea sarcasmo. Nada mal.</p>
</section>
<section id="bibliografia-recomendada">
<h2>Bibliografía recomendada<a class="headerlink" href="#bibliografia-recomendada" title="Permalink to this heading">#</a></h2>
<p><strong>framework</strong> Rumelhart, D. E.; Hinton, G. E.; y Mcclelland, J. L. A General Framework for Parallel Distributed Processing. En Rumelhart, D. E. &amp; Mcclelland, J. L., editores, <em>Parallel Distributed Processing: Explorations in the Microstructure of Cognition, Vol. 1: Foundations</em>, pp. 45–76. MIT Press, Cambridge, MA, 1986. <a class="reference external" href="https://www.cs.toronto.edu/~hinton/absps/pdp2.pdf">URL</a>.</p>
<p><strong>backprop</strong> Rumelhart, David E.; Hinton, Geoffrey E.; y Williams, Ronald J. Learning representations by back-propagating errors. <em>Nature, Vol. 323</em>(6088), 533-536, 1986. <a class="reference external" href="https://www.cs.toronto.edu/~hinton/absps/naturebp.pdf">URL</a>.</p>
<p><strong>zhang2021dive</strong> Zhang, Aston; Lipton, Zachary C.; Li, Mu y Smola, Alexander J. <em>Dive into Deep Learning</em>, 2021. <a class="reference external" href="https://d2l.ai/">URL</a>.</p>
<p><strong>howard2020deep</strong> Howard, J. y Gugger, S. <em>Deep Learning for Coders with Fastai and Pytorch: AI Applications Without a PhD</em>, 2020. ISBN 9781492045526. <a class="reference external" href="https://course.fast.ai/Resources/book.html">URL</a>.</p>
<p><strong>CS231n</strong> Karpathy, Andrej y Li, Fei-Fei. <em>CS231n: Deep Learning for Computer Vision</em>, 2016. <a class="reference external" href="https://youtube.com/playlist?list=PLkt2uSq6rBVctENoVBg1TpCC7OQi31AlC">URL</a>.</p>
<p><em>Posdata: También recomiendo <a class="reference external" href="http://karpathy.github.io/neuralnets/"><em>Hacker’s guide to Neural Networks</em></a>, de Andrej Karpathy, aunque él niegue su utilidad.</em></p>
<hr class="footnotes docutils" />
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>La palabra «secante» significa «cortar» en latín (<em>secare</em>), de manera que la línea secante es aquella que corta una figura cuando la toca en dos puntos. Por otro lado, la palabra «tangente» significa «tocar» en latín (<em>tangere</em>), de manera que la tangente es una línea que apenas toca en un punto a otra figura. La palabra «tangible» viene de la misma raíz y de ahí su significado también.</p>
</aside>
<aside class="footnote brackets" id="id6" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>A operar con varias funciones concatenadas entre sí se le denomina «composición de funciones». La composición o concatenación de funciones consiste en tomar la salida de una función para pasarla como entrada de otra, y así sucesivamente. Según el esquema de nuestra primera lección, podríamos expresarlo como <span class="math notranslate nohighlight">\(x \mapsto f(x) \mapsto g(f(x))\)</span>, etcétera. Una visualización luciría más o menos así: <img src='https://upload.wikimedia.org/wikipedia/commons/6/65/FunctionMachinesComposition.svg' width=300></p>
</aside>
<aside class="footnote brackets" id="id7" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>El nombre técnico de esta derivada es «derivada parcial», puesto que la función <span class="math notranslate nohighlight">\(L\)</span> está compuesta de múltiples variables que, a su vez, están concatenadas entre sí mediante otras funciones (suma y multiplicación). En ese sentido, <span class="math notranslate nohighlight">\(L\)</span> es una función compuesta, y deseamos saber la derivada (parcial) de dicha función con respecto a cada variable que la compone o, en otras palabras, queremos determinar de qué forma está influyendo cada variable en el resultado de la función. En síntesis, si tenemos solo una variable en la función, entonces hablamos de derivada; pero si tenemos más de una variable y estimamos la derivada con respecto a cada variable individual, entonces hablamos de derivada parcial. La derivada parcial utiliza la notación <span class="math notranslate nohighlight">\(\frac{\partial y(x, z)}{\partial x}\)</span> con una letra «d» cursiva (<span class="math notranslate nohighlight">\(\partial\)</span>) para distinguirse. Debemos ser cuidadosos de no confundirla con delta, la «d» griega (<span class="math notranslate nohighlight">\(\delta\)</span>).</p>
</aside>
<aside class="footnote brackets" id="id8" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>La elección de una función no lineal (tanh, ReLU, etc.) es una cuestión técnica que tiene que ver con el problema a tratar y con cómo fluyen a través de ellas los gradientes. Dado que nuestro problema es relativamente simple, podemos usar cualquiera. Por otro lado, aunque suene extraño que nuestro modelo pueda arrojar probabilidades negativas, eso no sucederá siempre y cuando nuestras entradas estén en el rango de valores que seleccionamos para el entrenamiento (<em>i. e.</em>, 0 a 5 en ambas variables). Si, por ejemplo, dijéramos que la calificación es 30 y el sentimiento 20, nuestro modelo interpretaría esto como una probabilidad de sarcasmo negativa. Es obligado mencionar <a class="reference external" href="https://cds.cern.ch/record/154856/files/pre-27827.pdf/">el paper</a> en el que el gran Feynman explica qué sentido tiene hablar de probabilidades negativas.</p>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/alfa"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="programacion.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Elementos de programación</p>
      </div>
    </a>
    <a class="right-next"
       href="calculo.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Elementos de cálculo infinitesimal</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#la-derivada-demostrada-segun-el-orden-geometrico">La derivada demostrada según el orden geométrico</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pero-para-que-sirve-la-derivada">Pero ¿para qué sirve la derivada?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pequegrad">Pequegrad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#la-regla-de-la-cadena-propagacion-hacia-atras">La regla de la cadena: propagación hacia atrás</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perceptron-multicapa">Perceptrón multicapa</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bibliografia-recomendada">Bibliografía recomendada</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dante Noguez
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>